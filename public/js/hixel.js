/*! For license information please see hixel.js.LICENSE.txt */
!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=4)}([function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){const{EventTarget:o,defineEventAttribute:i}=n(7),{detect:r}=n(8),s=r(),a=e.AudioContext||e.webkitAudioContext;class c extends o{constructor(t,e={},n={}){const{mimeType:o,audioBitsPerSecond:i,videoBitsPerSecond:r,bitsPerSecond:a}=e,{encoderWorkerFactory:u,OggOpusEncoderWasmPath:l,WebMOpusEncoderWasmPath:h}=n;if(super(),this._stream=t,this._state="inactive",this._mimeType=o||"",this._audioBitsPerSecond=i||a,this.workerState="inactive",!c.isTypeSupported(this._mimeType))throw new TypeError("invalid arguments, a MIME Type is not supported");switch(c._parseType(this._mimeType).subtype){case"wave":case"wav":this._mimeType="audio/wave";break;case"webm":this._mimeType="audio/webm";break;case"ogg":this._mimeType="audio/ogg";break;default:switch(s&&s.name){case"chrome":this._mimeType="audio/webm";break;case"firefox":this._mimeType="audio/ogg";break;case"edge":this._mimeType="audio/webm";break;case"ios":case"safari":this._mimeType="audio/wave";break;default:this._mimeType="audio/webm"}}switch(this._mimeType){case"audio/wave":this._wasmPath="";break;case"audio/webm":this._wasmPath=h||"";break;case"audio/ogg":this._wasmPath=l||"";break;default:throw new Error("Internal Error: Unexpected MIME Type: "+this._mimeType)}let p="";document.currentScript?p=document.currentScript.src:self.location&&(p=self.location.href),p=p.substr(0,p.lastIndexOf("/"))+"/encoderWorker.umd.js","function"==typeof c.encoderWorker&&(p=URL.createObjectURL(new Blob([`(${c.encoderWorker})()`]))),this._workerFactory="function"==typeof u?u:t=>new Worker(p),this._spawnWorker()}get stream(){return this._stream}get mimeType(){return this._mimeType}get state(){return this._state}get videoBitsPerSecond(){}get audioBitsPerSecond(){return this._audioBitsPerSecond}_spawnWorker(){this.worker=this._workerFactory(),this.worker.onmessage=t=>this._onmessageFromWorker(t),this.worker.onerror=t=>this._onerrorFromWorker(t),this._postMessageToWorker("loadEncoder",{mimeType:this._mimeType,wasmPath:this._wasmPath})}_postMessageToWorker(t,n={}){switch(t){case"loadEncoder":let{mimeType:o,wasmPath:i}=n;this.worker.postMessage({command:t,mimeType:o,wasmPath:i});break;case"init":let{sampleRate:r,channelCount:s,bitsPerSecond:a}=n;this.worker.postMessage({command:t,sampleRate:r,channelCount:s,bitsPerSecond:a}),this.workerState="encoding",this.source.connect(this.processor),this.processor.connect(this.context.destination);let c=new e.Event("start");this.dispatchEvent(c);break;case"pushInputData":let{channelBuffers:u,length:l,duration:h}=n;this.worker.postMessage({command:t,channelBuffers:u,length:l,duration:h});break;case"getEncodedData":case"done":this.worker.postMessage({command:t});break;default:throw new Error("Internal Error: Incorrect postMessage requested.")}}_onmessageFromWorker(t){const{command:n,buffers:o}=t.data;let i;switch(n){case"readyToInit":const{sampleRate:t,channelCount:r}=this;this.workerState="readyToInit","recording"===this.state&&this._postMessageToWorker("init",{sampleRate:t,channelCount:r,bitsPerSecond:this.audioBitsPerSecond});break;case"encodedData":case"lastEncodedData":let s=new Blob(o,{type:this._mimeType});i=new e.Event("dataavailable"),i.data=s,this.dispatchEvent(i),"lastEncodedData"===n&&(i=new e.Event("stop"),this.dispatchEvent(i),this.workerState="closed")}}_onerrorFromWorker(t){this.source.disconnect(),this.processor.disconnect(),this.worker.terminate(),this.workerState="closed";let n=["FileName: "+t.filename,"LineNumber: "+t.lineno,"Message: "+t.message].join(" - "),o=new e.Event("error");o.name="UnknownError",o.message=n,this.dispatchEvent(o)}_enableAudioProcessCallback(t){let e=0;this.processor.onaudioprocess=n=>{const{inputBuffer:o,playbackTime:i}=n,{sampleRate:r,length:s,duration:a,numberOfChannels:c}=o,u=new Array(c);for(let t=0;t<c;t++)u[t]=o.getChannelData(t);const l={channelBuffers:u,length:s,duration:a};this._postMessageToWorker("pushInputData",l),e+=a,e>=t&&(this._postMessageToWorker("getEncodedData"),e=0)}}start(t=Number.MAX_SAFE_INTEGER){if("inactive"!==this.state)throw new Error("DOMException: INVALID_STATE_ERR, state must be inactive.");if(t<0)throw new TypeError("invalid arguments, timeslice should be 0 or higher.");t/=1e3,"closed"===this.workerState&&this._spawnWorker(),this.context=new a;let e=this.stream.getAudioTracks();if(!e[0])throw new Error("DOMException: UnkownError, media track not found.");if(this.channelCount=e[0].getSettings().channelCount||1,this.sampleRate=this.context.sampleRate,this.source=this.context.createMediaStreamSource(this.stream),this.processor=this.context.createScriptProcessor(4096,this.channelCount,this.channelCount),this._state="recording",this._enableAudioProcessCallback(t),"readyToInit"===this.workerState){const{sampleRate:t,channelCount:e}=this;this._postMessageToWorker("init",{sampleRate:t,channelCount:e,bitsPerSecond:this.audioBitsPerSecond})}}stop(){if("inactive"===this.state)throw new Error("DOMException: INVALID_STATE_ERR, state must NOT be inactive.");this.source.disconnect(),this.processor.disconnect(),this.context.close(),this._postMessageToWorker("done"),this._state="inactive"}pause(){if("inactive"===this.state)throw new Error("DOMException: INVALID_STATE_ERR, state must NOT be inactive.");this.source.disconnect(),this.processor.disconnect();let t=new e.Event("pause");this.dispatchEvent(t),this._state="paused"}resume(){if("inactive"===this.state)throw new Error("DOMException: INVALID_STATE_ERR, state must NOT be inactive.");this.source.connect(this.processor),this.processor.connect(this.context.destination);let t=new e.Event("resume");this.dispatchEvent(t),this._state="recording"}requestData(){if("inactive"===this.state)throw new Error("DOMException: INVALID_STATE_ERR, state must NOT be inactive.");this._postMessageToWorker("getEncodedData")}static isTypeSupported(t){if("string"==typeof t&&!t)return!0;try{var{type:e,subtype:n,codec:o}=c._parseType(t)}catch(t){return!1}if("audio"!==e||"ogg"!==n&&"webm"!==n&&"wave"!==n&&"wav"!==n)return!1;switch(n){case"ogg":case"webm":if("opus"!==o&&o)return!1;break;case"wave":case"wav":if(o)return!1}return!0}static _parseType(t){try{const i=/^(\w+)\/(\w+)(;\s*codecs=(\w+))?$/;var[,e,n,,o]=t.match(i)}catch(e){return"string"!=typeof t||t?null:{type:"",subtype:"",codec:""}}return{type:e,subtype:n,codec:o}}}var u;["start","stop","dataavailable","pause","resume","error"].forEach(t=>i(c.prototype,t)),s&&"edge"===s.name&&(u=Worker.prototype.postMessage,Worker.prototype.postMessage=function(t,e=null){u.apply(this,[t])}),t.exports=c}).call(this,n(1))},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function s(){return(s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=c(t);if(e){var i=c(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return l(this,n)}}var p=function(){function t(e){o(this,t),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",broadcaster:"pusher",csrfToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(e),this.connect()}return r(t,[{key:"setOptions",value:function(t){return this.options=s(this._defaultOptions,t),this.csrfToken()&&(this.options.auth.headers["X-CSRF-TOKEN"]=this.csrfToken()),t}},{key:"csrfToken",value:function(){var t;return"undefined"!=typeof window&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:"undefined"!=typeof document&&"function"==typeof document.querySelector&&(t=document.querySelector('meta[name="csrf-token"]'))?t.getAttribute("content"):null}}]),t}(),d=function(){function t(){o(this,t)}return r(t,[{key:"listenForWhisper",value:function(t,e){return this.listen(".client-"+t,e)}},{key:"notification",value:function(t){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",t)}},{key:"stopListeningForWhisper",value:function(t,e){return this.stopListening(".client-"+t,e)}}]),t}(),f=function(){function t(e){o(this,t),this.setNamespace(e)}return r(t,[{key:"format",value:function(t){return"."===t.charAt(0)||"\\"===t.charAt(0)?t.substr(1):(this.namespace&&(t=this.namespace+"."+t),t.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(t){this.namespace=t}}]),t}(),v=function(t){a(n,t);var e=h(n);function n(t,i,r){var s;return o(this,n),(s=e.call(this)).name=i,s.pusher=t,s.options=r,s.eventFormatter=new f(s.options.namespace),s.subscribe(),s}return r(n,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(t,e){return this.on(this.eventFormatter.format(t),e),this}},{key:"stopListening",value:function(t,e){return e?this.subscription.unbind(this.eventFormatter.format(t),e):this.subscription.unbind(this.eventFormatter.format(t)),this}},{key:"subscribed",value:function(t){return this.on("pusher:subscription_succeeded",(function(){t()})),this}},{key:"error",value:function(t){return this.on("pusher:subscription_error",(function(e){t(e)})),this}},{key:"on",value:function(t,e){return this.subscription.bind(t,e),this}}]),n}(d),y=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"whisper",value:function(t,e){return this.pusher.channels.channels[this.name].trigger("client-".concat(t),e),this}}]),n}(v),m=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"whisper",value:function(t,e){return this.pusher.channels.channels[this.name].trigger("client-".concat(t),e),this}}]),n}(v),g=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"here",value:function(t){return this.on("pusher:subscription_succeeded",(function(e){t(Object.keys(e.members).map((function(t){return e.members[t]})))})),this}},{key:"joining",value:function(t){return this.on("pusher:member_added",(function(e){t(e.info)})),this}},{key:"leaving",value:function(t){return this.on("pusher:member_removed",(function(e){t(e.info)})),this}},{key:"whisper",value:function(t,e){return this.pusher.channels.channels[this.name].trigger("client-".concat(t),e),this}}]),n}(v),b=function(t){a(n,t);var e=h(n);function n(t,i,r){var s;return o(this,n),(s=e.call(this)).events={},s.listeners={},s.name=i,s.socket=t,s.options=r,s.eventFormatter=new f(s.options.namespace),s.subscribe(),s}return r(n,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(t,e){return this.on(this.eventFormatter.format(t),e),this}},{key:"stopListening",value:function(t,e){return this.unbindEvent(this.eventFormatter.format(t),e),this}},{key:"subscribed",value:function(t){return this.on("connect",(function(e){t(e)})),this}},{key:"error",value:function(t){return this}},{key:"on",value:function(t,e){var n=this;return this.listeners[t]=this.listeners[t]||[],this.events[t]||(this.events[t]=function(e,o){n.name===e&&n.listeners[t]&&n.listeners[t].forEach((function(t){return t(o)}))},this.socket.on(t,this.events[t])),this.listeners[t].push(e),this}},{key:"unbind",value:function(){var t=this;Object.keys(this.events).forEach((function(e){t.unbindEvent(e)}))}},{key:"unbindEvent",value:function(t,e){this.listeners[t]=this.listeners[t]||[],e&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!==e}))),e&&0!==this.listeners[t].length||(this.events[t]&&(this.socket.removeListener(t,this.events[t]),delete this.events[t]),delete this.listeners[t])}}]),n}(d),w=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"whisper",value:function(t,e){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(t),data:e}),this}}]),n}(b),k=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"here",value:function(t){return this.on("presence:subscribed",(function(e){t(e.map((function(t){return t.user_info})))})),this}},{key:"joining",value:function(t){return this.on("presence:joining",(function(e){return t(e.user_info)})),this}},{key:"leaving",value:function(t){return this.on("presence:leaving",(function(e){return t(e.user_info)})),this}}]),n}(w),_=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(t,e){return this}},{key:"stopListening",value:function(t,e){return this}},{key:"subscribed",value:function(t){return this}},{key:"error",value:function(t){return this}},{key:"on",value:function(t,e){return this}}]),n}(d),S=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"whisper",value:function(t,e){return this}}]),n}(_),T=function(t){a(n,t);var e=h(n);function n(){return o(this,n),e.apply(this,arguments)}return r(n,[{key:"here",value:function(t){return this}},{key:"joining",value:function(t){return this}},{key:"leaving",value:function(t){return this}},{key:"whisper",value:function(t,e){return this}}]),n}(_),O=function(t){a(n,t);var e=h(n);function n(){var t;return o(this,n),(t=e.apply(this,arguments)).channels={},t}return r(n,[{key:"connect",value:function(){void 0!==this.options.client?this.pusher=this.options.client:this.pusher=new Pusher(this.options.key,this.options)}},{key:"listen",value:function(t,e,n){return this.channel(t).listen(e,n)}},{key:"channel",value:function(t){return this.channels[t]||(this.channels[t]=new v(this.pusher,t,this.options)),this.channels[t]}},{key:"privateChannel",value:function(t){return this.channels["private-"+t]||(this.channels["private-"+t]=new y(this.pusher,"private-"+t,this.options)),this.channels["private-"+t]}},{key:"encryptedPrivateChannel",value:function(t){return this.channels["private-encrypted-"+t]||(this.channels["private-encrypted-"+t]=new m(this.pusher,"private-encrypted-"+t,this.options)),this.channels["private-encrypted-"+t]}},{key:"presenceChannel",value:function(t){return this.channels["presence-"+t]||(this.channels["presence-"+t]=new g(this.pusher,"presence-"+t,this.options)),this.channels["presence-"+t]}},{key:"leave",value:function(t){var e=this;[t,"private-"+t,"presence-"+t].forEach((function(t,n){e.leaveChannel(t)}))}},{key:"leaveChannel",value:function(t){this.channels[t]&&(this.channels[t].unsubscribe(),delete this.channels[t])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),n}(p),C=function(t){a(n,t);var e=h(n);function n(){var t;return o(this,n),(t=e.apply(this,arguments)).channels={},t}return r(n,[{key:"connect",value:function(){var t=this,e=this.getSocketIO();return this.socket=e(this.options.host,this.options),this.socket.on("reconnect",(function(){Object.values(t.channels).forEach((function(t){t.subscribe()}))})),this.socket}},{key:"getSocketIO",value:function(){if(void 0!==this.options.client)return this.options.client;if("undefined"!=typeof io)return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(t,e,n){return this.channel(t).listen(e,n)}},{key:"channel",value:function(t){return this.channels[t]||(this.channels[t]=new b(this.socket,t,this.options)),this.channels[t]}},{key:"privateChannel",value:function(t){return this.channels["private-"+t]||(this.channels["private-"+t]=new w(this.socket,"private-"+t,this.options)),this.channels["private-"+t]}},{key:"presenceChannel",value:function(t){return this.channels["presence-"+t]||(this.channels["presence-"+t]=new k(this.socket,"presence-"+t,this.options)),this.channels["presence-"+t]}},{key:"leave",value:function(t){var e=this;[t,"private-"+t,"presence-"+t].forEach((function(t){e.leaveChannel(t)}))}},{key:"leaveChannel",value:function(t){this.channels[t]&&(this.channels[t].unsubscribe(),delete this.channels[t])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),n}(p),P=function(t){a(n,t);var e=h(n);function n(){var t;return o(this,n),(t=e.apply(this,arguments)).channels={},t}return r(n,[{key:"connect",value:function(){}},{key:"listen",value:function(t,e,n){return new _}},{key:"channel",value:function(t){return new _}},{key:"privateChannel",value:function(t){return new S}},{key:"presenceChannel",value:function(t){return new T}},{key:"leave",value:function(t){}},{key:"leaveChannel",value:function(t){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),n}(p),E=function(){function t(e){o(this,t),this.options=e,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return r(t,[{key:"channel",value:function(t){return this.connector.channel(t)}},{key:"connect",value:function(){"pusher"==this.options.broadcaster?this.connector=new O(this.options):"socket.io"==this.options.broadcaster?this.connector=new C(this.options):"null"==this.options.broadcaster?this.connector=new P(this.options):"function"==typeof this.options.broadcaster&&(this.connector=new this.options.broadcaster(this.options))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(t){return this.connector.presenceChannel(t)}},{key:"leave",value:function(t){this.connector.leave(t)}},{key:"leaveChannel",value:function(t){this.connector.leaveChannel(t)}},{key:"listen",value:function(t,e,n){return this.connector.listen(t,e,n)}},{key:"private",value:function(t){return this.connector.privateChannel(t)}},{key:"encryptedPrivate",value:function(t){return this.connector.encryptedPrivateChannel(t)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){"function"==typeof Vue&&Vue.http&&this.registerVueRequestInterceptor(),"function"==typeof axios&&this.registerAxiosRequestInterceptor(),"function"==typeof jQuery&&this.registerjQueryAjaxSetup()}},{key:"registerVueRequestInterceptor",value:function(){var t=this;Vue.http.interceptors.push((function(e,n){t.socketId()&&e.headers.set("X-Socket-ID",t.socketId()),n()}))}},{key:"registerAxiosRequestInterceptor",value:function(){var t=this;axios.interceptors.request.use((function(e){return t.socketId()&&(e.headers["X-Socket-Id"]=t.socketId()),e}))}},{key:"registerjQueryAjaxSetup",value:function(){var t=this;void 0!==jQuery.ajax&&jQuery.ajaxPrefilter((function(e,n,o){t.socketId()&&o.setRequestHeader("X-Socket-Id",t.socketId())}))}}]),t}();e.a=E},function(t,e,n){t.exports=n(5)},function(t,e,n){"use strict";n.r(e),function(t,e){var o=n(2),i=n.n(o),r=n(3);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}window.Pusher=n(10),window.Echo=new r.a({broadcaster:"pusher",key:"e4912263fe516a1f11dc",cluster:"us2",forceTLS:!0}),function(t,o){"object"===("undefined"==typeof exports?"undefined":a(exports))?e.exports=o(t):"function"==typeof define&&n(0)?define([],o):t.LazyLoad=o(t)}(void 0!==t?t:(void 0).window||(void 0).global,(function(t){"function"==typeof define&&n(0)&&(t=window);var e={src:"data-src",srcset:"data-srcset",selector:".lazyload",root:null,rootMargin:"0px",threshold:0};function o(t,n,o,i){this.settings=function t(){var e={},n=!1,o=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],o++);for(var r=function(o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n&&"[object Object]"===Object.prototype.toString.call(o[i])?e[i]=t(!0,e[i],o[i]):e[i]=o[i])};o<i;o++){var s=arguments[o];r(s)}return e}(e,n||{}),this.images=t||document.querySelectorAll(this.settings.selector),this.observer=null,this.cbp=o,this.cb=i,this.init()}if(o.prototype={init:function(){if(t.IntersectionObserver){var e=this,n={root:this.settings.root,rootMargin:this.settings.rootMargin,threshold:[this.settings.threshold]};this.observer=new IntersectionObserver((function(t){Array.prototype.forEach.call(t,(function(t){t.isIntersecting&&(e.observer.unobserve(t.target),e.workOn(t.target))}))}),n),Array.prototype.forEach.call(this.images,(function(t){e.observer.observe(t)}))}else this.loadImages()},workOn:function(t){var e=t.getAttribute(this.settings.src),n=t.getAttribute(this.settings.srcset);this.cbp&&this.cbp(t),"img"===t.tagName.toLowerCase()?(e&&(t.src=e),n&&(t.srcset=n)):t.style.backgroundImage="url("+e+")",this.cb&&this.cb(t)},loadAndDestroy:function(){this.settings&&(this.loadImages(),this.destroy())},loadImages:function(){this.settings&&Array.prototype.forEach.call(this.images,(function(t){this.workOn(t)}))},destroy:function(){this.settings&&(this.observer.disconnect(),this.settings=null)}},t.lazyload=function(t,e,n,i){return new o(t,e,n,i)},t.jQuery){var i=t.jQuery;i.fn.lazyload=function(t){return(t=t||{}).attribute=t.attribute||"data-src",new o(i.makeArray(this),t),this}}return o})),function(t){t.fn.getStyles=function(t,e){var n,o,i={};if(t&&t instanceof Array)for(var r=0,s=t.length;r<s;r++)i[o=t[r]]=this.css(o);else if(this.length){var a=this.get(0);if(window.getComputedStyle){var c,u,l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t.split(e).reduce((function(t,e){return"".concat(t).concat(e.charAt(0).toUpperCase()+e.slice(1))}),"")};if(n=window.getComputedStyle(a,null))if(n.length)for(r=0,s=n.length;r<s;r++)c=l(o=n[r]),u=n.getPropertyValue(o),i[c]=u;else for(o in n)c=l(o),u=n.getPropertyValue(o)||n[o],i[c]=u}else if(n=a.currentStyle)for(o in n)i[o]=n[o];else if(n=a.style)for(o in n)"function"!=typeof n[o]&&(i[o]=n[o])}if(e&&e instanceof Array)for(r=0,s=e.length;r<s;r++)delete i[o=e[r]];return i},t.fn.copyCSS=function(e,n,o){var i=t(e).getStyles(n,o);return this.css(i),this}}(jQuery);var c=function t(){s(this,t),this.apiUrl="/api/",this.invoke=function(t,e,n){$.ajax({url:this.apiUrl+t,method:"post",data:e}).done((function(t){t.success?n&&n():error(t.description)}))},this.postAction=function(t,e){this.invoke("postaction",t,e)}},u=function t(){s(this,t),this.time=0,this.paused=!1,this.interval=null,this.start=function(){this.interval||(this.time=0,this.interval=setInterval((function(t){t.paused||(t.time+=100)}),100,this))},this.restart=function(){this.time=0},this.pause=function(){this.paused=!0},this.stop=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ms";return this.interval&&clearInterval(this.interval),this.interval=null,this.getTime(t)},this.resume=function(){this.paused=!1},this.getTime=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ms";switch(t){case"ms":case"miliseconds":return this.time;case"sec":case"seconds":return this.time/1e3;case"min":case"minutes":return this.time/1e3/60}}};!function(t,o){"function"==typeof define&&n(0)?define([],o):"object"==("undefined"==typeof exports?"undefined":a(exports))?e.exports=o():window.Notifier=o()}(0,(function(){var t={autopush:!0,zindex:9999,default_time:4500,vanish_time:300,fps:30,position:"bottom-right",direction:"bottom",success:{classes:"notifyjs-success",textColor:"#155724",borderColor:"#c3e6cb",backgroundColor:"#d4edda",progressColor:"#155724",iconColor:"#155724",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M6.41 0l-.69.72-2.78 2.78-.81-.78-.72-.72-1.41 1.41.72.72 1.5 1.5.69.72.72-.72 3.5-3.5.72-.72-1.44-1.41z" transform="translate(0 1)" /></svg>'},error:{classes:"notifyjs-danger",textColor:"#721c24",borderColor:"#f5c6cb",backgroundColor:"#f8d7da",progressColor:"#721c24",iconColor:"#721c24",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.41 0l-1.41 1.41.72.72 1.78 1.81-1.78 1.78-.72.69 1.41 1.44.72-.72 1.81-1.81 1.78 1.81.69.72 1.44-1.44-.72-.69-1.81-1.78 1.81-1.81.72-.72-1.44-1.41-.69.72-1.78 1.78-1.81-1.78-.72-.72z" /></svg>'},warning:{classes:"notifyjs-warning",textColor:"#856404",borderColor:"#fff3cd",backgroundColor:"#ffeeba",progressColor:"#856404",iconColor:"#856404",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M3.09 0c-.06 0-.1.04-.13.09l-2.94 6.81c-.02.05-.03.13-.03.19v.81c0 .05.04.09.09.09h6.81c.05 0 .09-.04.09-.09v-.81c0-.05-.01-.14-.03-.19l-2.94-6.81c-.02-.05-.07-.09-.13-.09h-.81zm-.09 3h1v2h-1v-2zm0 3h1v1h-1v-1z" /></svg>'},info:{classes:"notifyjs-info",textColor:"#0c5460",borderColor:"#d1ecf1",backgroundColor:"#bee5eb",progressColor:"#0c5460",iconColor:"#0c5460",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M3 0c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-1.5 2.5c-.83 0-1.5.67-1.5 1.5h1c0-.28.22-.5.5-.5s.5.22.5.5-1 1.64-1 2.5c0 .86.67 1.5 1.5 1.5s1.5-.67 1.5-1.5h-1c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-.36 1-1.84 1-2.5 0-.81-.67-1.5-1.5-1.5z" transform="translate(2)"/></svg>'}},e=function(t,e,n,o,i,r,s){switch(this.pushed=!1,this.element=document.createElement("div"),this.element.className=n.classes||"",this.element.style.display="none",this.element.style.position="relative",this.element.style.padding="1em 2em 1em 2.5em",t.options.direction){case"top":this.element.style.marginTop="0.5em";break;case"bottom":default:this.element.style.marginBottom="0.5em"}if(this.element.style.width="100%",this.element.style.borderWidth="1px",this.element.style.borderStyle="solid",this.element.style.borderColor=n.borderColor,this.element.style.boxSizing="border-box",this.element.style.backgroundColor=n.backgroundColor,void 0!==n.icon){var a=document.createElement("div");a.style.position="absolute",a.style.top="50%",a.style.left="10px",a.style.transform="translateY(-50%)",a.innerHTML=n.icon,-1==n.icon.indexOf("<img")?-1!=n.icon.indexOf("<svg ")&&(a.childNodes[0].style.width="16px",a.childNodes[0].style.height="16px",void 0!==n.iconColor&&(a.childNodes[0].style.fill=n.iconColor)):(a.childNodes[0].style.width="16px",a.childNodes[0].style.height="16px"),void 0!==n.iconClasses&&(a.childNodes[0].className+=n.iconClasses),this.element.appendChild(a)}var c=document.createElement("span");c.style.color=n.textColor,c.innerHTML=e,this.element.appendChild(c);var u=document.createElement("p");switch(u.className="progress",u.style.position="absolute",u.style.bottom=0,u.style.left=0,u.style.right="100%",u.style.height="2px",u.style.content=" ",u.style.backgroundColor=n.progressColor,u.style.marginBottom=0,this.element.appendChild(u),t.options.direction){case"top":t.container.insertBefore(this.element,t.container.childNodes[0]);break;case"bottom":default:t.container.appendChild(this.element)}this.callback=s;var l=this;this.push=function(){if(!l.pushed){l.pushed=!0;var t=0,e=1e3/r;l.element.style.display="block",l.interval=setInterval((function(){t++;var n=100*(1-e*t/o);u.style.right=n+"%",0>=n&&("function"==typeof s&&s(),l.clear())}),e)}},this.clear=function(){if(l.pushed){var t=1e3/r,e=1;void 0!==l.interval&&clearInterval(l.interval),l.interval=setInterval((function(){e-=1/(i/t),l.element.style.opacity=e,0>=e&&(clearInterval(l.interval),l.destroy())}),t)}},this.destroy=function(){l.pushed&&(l.pushed=!1,void 0!==l.interval&&clearInterval(l.interval),t.container.removeChild(l.element))}};return function(n){if(this.options=Object.assign({},t),this.options=Object.assign(this.options,n),this.container=document.getElementById("notifyjs-container-"+this.options.position),null===this.container){switch(this.container=document.createElement("div"),this.container.id="notifyjs-container-"+this.options.position,this.container.style.zIndex=this.options.zindex,this.container.style.position="fixed",this.container.style.maxWidth="304px",this.container.style.width="100%",this.options.position){case"top-left":this.container.style.top=0,this.container.style.left="0.5em";break;case"top-right":this.container.style.top=0,this.container.style.right="0.5em";break;case"bottom-left":this.container.style.bottom=0,this.container.style.left="0.5em";break;case"bottom-right":default:this.container.style.bottom=0,this.container.style.right="0.5em"}document.getElementsByTagName("body")[0].appendChild(this.container)}this.notify=function(t,n,o,i){if(void 0!==this.options[t]){void 0===o&&(o=this.options.default_time);var r=new e(this,n,this.options[t],o,this.options.vanish_time,this.options.fps,i);return this.options.autopush&&r.push(),r}console.error("Notify.js: Error, undefined '"+t+"' notification type")}}})),Array.prototype.lastElement=function(){return this[this.length-1]},Array.prototype.randomElement=function(){return this[Math.floor(Math.random()*this.length)]},Array.prototype.clear=function(){this.length=0},!1 in window&&$(".post-speech-buttons").hide(),window.playspeech=function(t){var e=$(t),n=e.data("sid"),o=$("#stop-"+n),i=$("#pause-"+n),r=$("#resume-"+n),s=$("#p-content-"+n);speechSynthesis.cancel();var a=new SpeechSynthesisUtterance;a.voice=function(){for(var t=speechSynthesis.getVoices(),e=[],n=0;n<t.length;n++)"es-ES"===t[n].lang&&e.push(t[n]);return e.randomElement()}(),a.rate=a.volume=a.pitch=1,a.text=s.text().trim(),a.lang="es-ES",a.onstart=function(){e.hide(),r.hide(),i.css("display","inline-block"),o.css("display","inline-block")},a.onend=function(){o.hide(),i.hide(),r.hide(),e.css("display","inline-block")},a.onpause=function(){e.hide(),i.hide(),r.css("display","inline-block")},a.onresume=function(){e.hide(),r.hide(),i.css("display","inline-block")},speechSynthesis.speak(a)},window.onload=function(){var t=$(".record-record"),e=$(".record-stop"),n=$("#record-audio"),o=$(".record-remove"),r=[],s='<i class="fa fa-microphone" data-s="1"></i>',a='<i class="fa fa-circle"></i>',l='<i class="fa fa-microphone"></i>',h='<i class="fa fa-paper-plane-o">',p=null,d=null,f=!0,v=1,y=$("#content"),m=$("#form-comment textarea"),g="board"===urlocation,b=new Notifier,w=!1,k=$('i[name="imgstatus"]'),_=$('i[name="imgurlstatus"]'),S=$("#categoryselector"),T=$("#themeselector"),O=new c,C=$(".upload-label"),P=$(".form-post-image-preview"),E=$(".form-post-image-preview i"),x={verified:!1,type:"i",url:""},A=$(".form-post-image-preview img"),j=$("#imgmodal"),I=$("#fullsizeimg");function L(){return g?'.preview[data-pid="'.concat(pid,'"]'):'.post-container[data-pid="'.concat(pid,'"]')}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;t.style.display="inline-block",t.style.opacity=0;var n=+new Date,o=function o(){t.style.opacity=+t.style.opacity+(new Date-n)/e,n=+new Date,+t.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()}window.pid=0;var M=[];function D(){lazyload(void 0,void 0,void 0,(function(t){M.includes(t)||(R(t),M.push(t))}))}function B(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=$(this||t);return 1==e.attr("value")?(e.removeAttr("value"),e.attr("class","fa fa-square"),!1):(e.attr("value",1),e.attr("class","fa fa-check-square"),!0)}function N(t){return["","Destacado","Oficial","Resuelto","Verificado","Subnormal","Genio","This","Confirmado","Fake","Bait","Ultrajado","Importante"][t]}function W(t){for(var e=0;e<t.length;e++){var n=(o=t[e],i=void 0,r=void 0,s=void 0,i=o.preview||"/public/img/default.webp",r=N(o.status),s='<div class="preview" data-type="'.concat(o.status,'" data-pid="').concat(o.id,'" onmousedown="pid = ').concat(o.id,'">\n            <a href="').concat(o.url,'"><img ').concat(o.censoredf?'type="censored" ':"",'class="lazyload" data-src="').concat(i,'"></a>\n            <div class="p-left">\n                <div class="p-category">').concat(o.category,'</div>\n                <div class="p-hide"><i class="fa fa-eye" onclick="markPostFromIndex(this,').concat(o.id,',1)"></i></div>\n                <div class="p-hide"><i class="fa fa-star').concat(o.fav?"":"-o",'" onclick="markPostFromIndex(this,').concat(o.id,',2)" ').concat(o.fav?'style="color:yellow;"':"",'></i></div>\n                <div class="p-report"><i class="fa fa-exclamation" onclick="reportPost(').concat(o.id,')"></i></div>\n            </div>\n            <div class="p-c-counter"><i class="fa fa-comments">').concat(o.cc,'</i></div>\n            <div class="p-status">').concat(r,'</div>\n            <a href="').concat(o.url,'"><div class="p-title">').concat(o.title,"</div></a>\n        </div>"),$(s));y.append(n)}var o,i,r,s}function H(){f?w||($.ajax({url:"/api/getposts",method:"post",data:{page:v,category:cid,last_time:null}}).done((function(t,e,n){if(!t.success)return error(t.description),void(f=!1);W(t[0]),v++,w=!1,D()})).fail((function(t,e,n){error("Se produjo un error interno en el servidor, contacte con el administrador."),w=!1})),w=!0):alert("No hay más publicaciones.")}function z(t){var e,n,o=N(t.status),i=function(t,e){for(var n="",o=0;o<t.length;o++)0!==o&o!==t.length&&(n+=" "),n+='<a href="'.concat(t[o].url,'"><i class="').concat(e,'" onmouseover="onOverShowComment(this,\'').concat(t[o].sid,"')\">").concat(t[o].sid,"</i></a>");return n};e=i(t.comments,"fa fa-caret-right"),n=i(t.responses,"fa fa-caret-left");var r=t.front.censored,s="";switch(t.front.type){case 1:s='<div class="front-image"><img '.concat(r?'type="censored" ':"").concat(t.front.animated|r?'style="cursor:pointer;" onclick="setImgUrl(this,\''.concat(t.front.hq,"')\" "):"",'src="').concat(t.front.sq,'">\n                    <div class="img-bar">\n                        ').concat(t.front.animated?'<i class="fa fa-film"></i>&nbsp;':"",'<a href="').concat(t.front.hq,'" target="_blank"><i class="fa fa-expand"></i></a>').concat(r?'<i class="fa fa-exclamation-triangle"></i>':"","\n                    </div>\n                </div>");break;case 2:s='<div class="video-bb">\n                    <img '.concat(r?'type="censored"':"",'src="https://img.youtube.com/vi/').concat(t.front.extra,'/mqdefault.jpg">\n                    <div class="play-button" data-urltype="ytb" data-v="').concat(t.front.extra,'" onclick="playVideo(this)">\n                        <i class="fa fa-play-circle"></i>\n                    </div>\n                    <div class="img-bar">\n                        <a href="https://www.youtube.com/watch?v=').concat(t.front.extra,'" target="_blank"><i class="fa fa-expand"></i></a>').concat(r?'<i class="fa fa-exclamation-triangle"></i>':"","\n                    </div>\n                </div>")}var a='<div class="post-front">\n            '.concat(s,"\n        </div>");return 1===t.only&&(t.htmlcontent=a),$('\n        <div class="post-container" id="'.concat(t.sid,'" ').concat(t.iscomment?'data-type="'.concat(t.extra,'"'):"",' data-usid="').concat(t.userid,'" data-pid="').concat(t.id,'"  onmousedown="pid = ').concat(t.id,'">\n            ').concat(1!==t.only?"".concat(t.front.exists?a:""):"",'\n            <div class="post-status" data-type="').concat(t.status,'">').concat(o,'</div>\n            <a href="').concat(t.url,'"><h3 class="post-title">').concat(t.iscomment?t.sid:t.title,"</h3></a>").concat(t.iscomment?'&nbsp;<i class="fa fa-tag" onclick="addTag(\''.concat(t.sid,"');\"></i>"):"",'\n            <p class="p-responses">').concat(n,'</p>\n            <p class="p-comments">').concat(e,'</p>\n            <div class="post-content" id="p-content-').concat(t.sid,'">').concat(t.htmlcontent,"</div>\n            ").concat(t.audio.exists>0?'<div class="post-audio"><audio src="'.concat(t.audio.src,'" controls>Tu navegador no soporta controles de audio</audio></div>'):"",'\n            <div class="post-footer">\n                <div class="post-speech-buttons">\n                    <i id="play-').concat(t.sid,'" class="fa fa-play" onclick="playspeech(this)" data-sid="').concat(t.sid,'"></i>\n                    <i id="pause-').concat(t.sid,'" class="fa fa-pause" onclick="speechSynthesis.pause()" style="display:none;"></i>\n                    <i id="resume-').concat(t.sid,'" class="fa fa-play" onclick="speechSynthesis.resume()" style="display:none;"></i>\n                    <i id="stop-').concat(t.sid,'" class="fa fa-stop" onclick="speechSynthesis.cancel()" style="display:none;"></i>\n                </div>\n                <div class="post-information">\n                    <i class="fa fa-clock-o">&nbsp;').concat(t.timediff,'</i>\n                    <i class="fa fa-user-circle-o">&nbsp;').concat(t.usernickname,"</i>\n                </div>\n            </div>\n        </div>"))}function U(t,e){var n=$("#pc"),o=$("#cc");z(t).appendTo(n);for(var i=0;i<e.length;i++){z(e[i]).appendTo(o)}document.querySelectorAll("pre code").forEach((function(t){hljs.highlightBlock(t)}))}function F(t){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)}function q(t,e){return new Promise((function(n,o){var i,r=e||5e3,s=new Image,a={url:t,img:s,status:""};s.onerror=s.onabort=function(){clearTimeout(i),a.status="error",o(a)},s.onload=function(){clearTimeout(i),a.status="success",n(a)},i=setTimeout((function(){a.status="timeout",o(a)}),r),s.src=t}))}function X(t){return-1!==t.indexOf("youtu")}function V(t){return-1!==t.indexOf("daylimotion")}function J(t){var e=document.getElementById("form-post-image-file"),n=$("#record-audio"),i=$("#form-post .title"),s=$("#form-post select"),a=!1;"form-comment"===t.target.id.toString()&&(a=!0);var c=$("#form-".concat(a?"comment":"post",' button[type="submit"]')),u=$('#form-comment > input[type="hidden"]'),l=$("#form-".concat(a?"comment":"post"," textarea")),p=$('input[name="fronturl"]').val();if(t.preventDefault(),a){if(0===parseInt(u.val(),10))return void alert("PostID Inválido.")}else{if(""===i.val())return void alert("Se requiere un título.");if(i.val().length>100)return void alert("El título de la publicación no puede contener más de 100 carácteres.")}if(p){if(p.length>0&&!F(p))return void alert("URL de la imagen/video inválida.");if(0===p.length)return void alert("Se esperaba URL de la imagen o vídeo.");if(!x.verified)return void error("La URL aún no fue verificada o es inválida.")}if(""===l.val()&0===e.files.length&void 0===n.attr("src")&""===(p||""))alert("Se espera algún tipo de contenido.");else if(""!==l.val()&!function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(e?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}(l.val()))alert("El contenido de la publicación no puede contener carácteres raros.");else{d&&d.abort();var f=new FormData;a?parseInt(u.val(),10)>0&&f.append("postid",u.val()):(f.append("title",i.val()),f.append("category",s.val()),"undefined"!=typeof grecaptcha&&f.append("g-recaptcha-response",grecaptcha.getResponse())),""!==l.val()&&f.append("content",l.val()),void 0!==n.attr("src")&&f.append("audiodata",r[0]),1==k.attr("value")&&f.append("censorefront",!0),1==_.attr("value")?(f.append("fronturl",x.url),f.append("fronttype",x.type)):e.files.length>0&&f.append("front",e.files[0]),c.attr("disabled",!0),c.html('<i class="fa fa-spinner">'),d=$.ajax({url:"/api/".concat(a?"commentsubmit":"postsubmit"),method:"post",data:f,cache:!1,contentType:!1,processData:!1,progress:function(t){t.lengthComputable&&showProgressBar(t.loaded,t.total)}}).done((function(t){c.attr("disabled",!1),c.html(h),hideProgressBar(),t.success?(l.val(""),n.removeAttr("src"),E.trigger("click"),o.trigger("click"),a||(window.open(t.url,"_blank"),i.val("")),success("¡Publicación enviada!")):alert(t.description)})).fail((function(t,e,n){c.attr("disabled",!1),c.html(h),hideProgressBar(),429===t.status?error("Espere un minuto para volver a publicar."):error("Se produjo un error inesperado.")}))}}_.on("click",(function(){if(B(this)){var t=$('<input type="text" placeholder="Enlace" name="fronturl">');C.removeAttr("for"),C.html(t),t.on("input",(function(){var e,n=$(this).val(),o=function(t,e){if(-1!==e.url.match("ytimg")&&120===e.img.naturalWidth&&90===e.img.naturalHeight)return x.verified=!1,error("Parece ser que el vídeo no existe."),void E.trigger("click");success("Imagen obtenida con éxito."),A.attr("src",e.url),P.show(),x.verified=!0,x.url=t.url,x.type=t.type},i=function(){error("No se pudo descargar la imagen."),E.trigger("click"),x.verified=!1};if(F(n))switch(!0){case F(e=n)&&function(t){return null!=t.match(/\.(jpeg|jpg|gif|png|webp|bmp)$/)}(e):q(n).then(o.bind(t,{url:n,type:"i"}),i);break;case X(n):var r;if(!1===(r=function(t){var e;return((e=t.match(/(?:https:\/\/)?www\.youtube\.com\/watch\?v=([a-zA-Z0-9_-]+)(?:.*)?/m))||!!(e=t.match(/(?:https?:\/\/)?[www\.]?(?:youtu|y2u)\.be\/([a-zA-Z0-9_-]+)(?:.*)?/m)))&&e[1]}(n)))return void error("Enlace de youtube inválido.");q("https://i.ytimg.com/vi/".concat(r,"/hqdefault.jpg")).then(o.bind(t,{url:r,type:"ytb"}),i);break;case V(n):}}))}else C.attr("for","form-post-image-file"),C.html('Subir archivo <i class="fa fa-upload" aria-hidden="true"></i>')})),k.on("click",B),$("#reorder").on("click",(function(){T.toggle(),S.toggle()})),$("#search-button").on("click",(function(){var t=$("#search-text").val();0!==t.length?location.href="/search?words="+encodeURI(t):alert("Se esperaban palabras a buscar.")})),S.on("change",(function(){location.href="/"+$(this).val()})),T.on("change",(function(){var t=$("#theme"),e=$(this),n=e.val(),o=e.find(":selected").data("path");$.ajax({url:"/api/changetheme",method:"post",data:{themeid:n}}).done((function(e,n,i){t.attr("href",o),success("Tema modificado con éxito.")}))})),$("#hidecategory").on("click",(function(){$(this).attr("class","fa fa-spinner"),$.ajax({url:"/api/hidecategory",method:"post",data:{categoryid:cid}}).done((function(t,e,n){t.success?($("#hidecategory").attr("class",t.hidden?"fa fa-toggle-off":"fa fa-toggle-on"),t.hidden?success("Esta categoría fue escondida del indice general."):success("Esta categoría ahora es visible en el indice general.")):error(t.description)}))})),window.reportPost=function(t){confirm("¿Reportar?\nUn mal uso de esta herramienta puede ser motivo de baneo permanente. ¿Continuar?")&&markPostFromIndex(null,t,3)},window.markPostFromIndex=function(t,e,n){if(t)var o=(t=$(t)).parent().parent().parent();var i;$.ajax({url:"/api/markpost",method:"post",data:{postid:e,type:n}}).done((function(e,r,s){if(e.success){switch(n){case 1:i=0===e.newtype?"Publicación removida de escondidos.":"Publicación escondida.",o.hide();break;case 2:0===e.newtype?(i="Publicación removida de favoritos.",t.attr("class","fa fa-star-o"),t.css("color","white")):(i="Publicación añadida a favoritos.",t.attr("class","fa fa-star"),t.css("color","yellow"));break;case 3:i="Publicación reportada al STAFF exitosamente."}success(i)}else alert(e.description)}))},window.addTag=function(t){if(-1===t.indexOf(">")&&(t=">"+t),-1===m.val().indexOf(t)){var e=m.val().substr(m.val().length-1);"\n"!==e&""!==e&&m.val(m.val()+"\r\n"),m.val(m.val()+t+"\r\n")}},window.playVideo=function(t){var e=$(t),n=e.data("urltype"),o=e.data("v");switch(n){case"ytb":e.parent().replaceWith('<iframe width="100%" height="60%" src="https://www.youtube.com/embed/'.concat(o,'?autoplay=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'));break;case"dlm":e.parent().replaceWith('<div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;"> <iframe style="width:100%;height:100%;position:absolute;left:0px;top:0px;overflow:hidden" frameborder="0" type="text/html" src="https://www.dailymotion.com/embed/video/'.concat(o,'?autoplay=1" width="100%" height="100%" allowfullscreen allow="autoplay"></iframe></div>'))}e.trigger("click")},window.onOverShowComment=function(t,e){var n=$("#comment-popup");function o(){n.hide(),n.html(""),n.css("display","")}$(t).on("mousedown",o),$(t).on("mouseleave",o),$(t).on("mousewheel",o);var i=t.getBoundingClientRect(),r=$("#"+e);t=$(t);var s=i.left+t.width()+10,a=i.top,c=.4*document.body.clientWidth,u=s+c,l=u-document.body.clientWidth;n.css(r.getStyles()),l>0&&l<=200?c-=l+25:u>document.body.clientWidth&&(s=i.left-c-20),n.html(r.html());var h=a+n.outerHeight();h>document.body.clientHeight&&(a-=h-document.body.clientHeight),n.css({position:"fixed",display:"block",width:c,zIndex:2,left:s,top:a})},window.setImgUrl=function(t,e){var n=$(t);n.attr("src")!==e&&(n.removeAttr("type"),n.attr("style","cursor:initial"),n.attr("src",e),R(t))},window.bbParse=function(t){var e=["<b>$1</b>"];return[/\[b\](.*?)\[\/b\]/i].forEach((function(n,o){console.log(n),t=t.replace(n,e[o])})),t},window.showImageOnModal=function(t){I.attr("src",t),j.show()},$("#form-comment").on("submit",J),$("#form-post").on("submit",J);var G={encoderWorkerFactory:function(){return new Worker("/public/js/encoderWorker.umd.js")},OggOpusEncoderWasmPath:"/public/js/wasm/OggOpusEncoder.wasm",WebMOpusEncoderWasmPath:"/public/js/wasm/WebMOpusEncoder.wasm"};window.MediaRecorder=i.a;var Q=new u;t.on("click",(function(){var i;$(this).html()===a?p.pause():$(this).html()===s?p.resume():(i=function(){p.start(),e.show()},navigator.mediaDevices.getUserMedia({audio:!0}).then((function(c){(p=new MediaRecorder(c,{audioBitsPerSecond:32e3,mimeType:"audio/ogg"},G)).ondataavailable=function(t){r.push(t.data)},p.onstop=function(){if(t.html(l),e.hide(),o.show(),Q.stop()>3e4)return error("No se pueden enviar audios de más de 30 segundos de duración."),r.clear(),void o.trigger("click");var i=new Blob(r,{type:"audio/ogg"}),s=URL.createObjectURL(i);n.attr("src",s),n.show()},p.onpause=function(){t.html(s),Q.pause()},p.onstart=function(){r.clear(),n.attr("src",""),o.hide(),n.hide(),t.html(a),Q.start()},p.onresume=function(){t.html(a),Q.resume()},i&&i()})))})),o.on("click",(function(){n.attr("src",""),o.hide(),n.hide(),t.html(l),r.clear(),p&&p.stream.getTracks().forEach((function(t){return t.stop()}))})),e.on("click",(function(){p.stop()})),$("#button-publicate").on("click",(function(){$("#modal-publication").css("display","flex")})),$("#form-post-image-file").on("change",(function(t){var e=t.currentTarget.files,n=new FileReader,o=$("#form-".concat("board"===urlocation?"post":"comment"," img"));n.onload=function(t){o.attr("src",t.target.result)},n.readAsDataURL(e[0]),P.show()})),$(window).on("paste",(function(t){var e=document.getElementById("form-post-image-file"),n=(t.clipboardData||t.originalEvent.clipboardData).files;n.length>0&&(e.files=n,$(e).trigger("change"))})),document.onkeydown=function(t){var e=$(".modal");27===(t.key|t.keyIdentifier|t.keyCode|t.which|t.charCode)&e.is(":visible")&&e.hide()},window.showProgressBar=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=$("#progressbar"),o=$("#progressbar progress");n.is(":visible")?progressBarUpdate(t):(n.show(),o.attr("value",t),o.attr("max",e))},window.progressBarUpdate=function(t){$("#progressbar progress").attr("value",t)},window.hideProgressBar=function(){$("#progressbar").hide()},window.alert=function(t){b.notify("warning",t)},window.error=function(t){b.notify("error",t)},window.information=function(t){b.notify("info",t)},window.success=function(t){b.notify("success",t)},function(){for(var t=0;t<categories.length;t++){var e=categories[t];0===urstatus&1===e.access||S.append("<option ".concat(e.id===cid?"selected ":"",'value="').concat(e.diminutive,'">').concat(e.identifier,"</option>"))}}(),function(){for(var t=0;t<themes.length;t++){var e=themes[t];T.append("<option ".concat(e.id===urtheme?"selected ":"",'value="').concat(e.id,'" data-path="').concat(e.path,'">').concat(e.name,"</option>"))}}(),function(){var t,e,n=g?".preview":".post-container",o=function(){var t={0:"Estandar",3:"Resuelto",4:"Verificado",5:"Subnormal",6:"Genio",7:"This",8:"Confirmado",9:"Fake",10:"Bait",11:"Ultrajado",12:"Importante"};return 1===urstatus&&(t[1]="Destacado",t[2]="Oficial"),t};switch(urstatus){case 0:return;case 1:$.contextMenu({selector:n,callback:function(e,n){switch(e){case"banapply":t=n.inputs.bantime.$input[0].options,n.inputs.bandelyesno.$input[0].checked?O.postAction({action:"bananddel",postid:pid,bantime:t[t.selectedIndex].value,deleteall:n.inputs.bandelallyesno.$input[0].checked},(function(){n.$trigger.hide(),success("El usuario fue baneado y la publicación eliminada.")})):O.postAction({action:"ban",postid:pid,bantime:t[t.selectedIndex].value},(function(){success("El usuario fue baneado.")}));break;case"delpost":O.postAction({action:"delete",postid:pid},(function(){n.$trigger.hide(),success("La publicación fue eliminada.")}));break;case"apppost":var i=(t=n.inputs.movpost.$input[0].options)[t.selectedIndex].value,r=(t=n.inputs.stapost.$input[0].options)[t.selectedIndex].value-0;O.postAction({action:"modifypost",postid:pid,category:i,status:r},(function(){if(g)$("".concat(L()," .p-category")).text(categories[i-1].diminutive),$(L()).data("type",r),$("".concat(L()," .p-status")).text(o()[r]);else{var t=$("".concat(L()," .post-status"));t.data("type",r),t.text(o()[r])}success("Publicación modificada con éxito.")}));break;case"banimage":case"delimage":O.postAction({action:e,postid:pid},(function(){$("".concat(L()," img")).attr("src","/public/img/l/default.webp"),success("Imagen modificada con éxito.")}));break;case"cenimg":O.postAction({action:"censoreimg",postid:pid},(function(){$("".concat(L()," img")).attr("type","censored"),success("Imagen modificada con éxito.")}));break;case"uncenimg":O.postAction({action:"uncensoreimg",postid:pid},(function(){$("".concat(L()," img")).removeAttr("type"),success("Imagen modificada con éxito.")}));break;case"delallpost":O.postAction({action:"delallpost",postid:pid},(function(){var t=$("".concat(L())).data("usid");$("".concat(L(),'[data-usid="').concat(t,'"]')).hide(),success("Las publicaciones fueron borradas con éxito.")}))}},items:{ban:{name:"Banear...",items:{bandelyesno:{name:"Borrar",type:"checkbox",selected:!1},bandelallyesno:{name:"Borrar Todo",type:"checkbox",selected:!1},bantime:{name:"Tiempo:",type:"select",options:{1:"1 Hora",12:"12 Hora",24:"24 Hora",48:"2 Días",168:"7 Días",336:"14 Días",720:"30 Días",2399976:"Permanentemente"},selected:1},banapply:{name:"Aplicar"}}},post:{name:"Publicación...",items:{delpost:{name:"Borrar"},delallpost:{name:"Borrar todas del usuario"},movpost:{name:"Mover a...",type:"select",options:(e={},categories.forEach((function(t,n,o){e[t.id]=t.identifier})),e),selected:cid},stapost:{name:"Estado...",type:"select",options:o(),selected:0},apppost:{name:"Aplicar"}}},img:{name:"Imagen...",items:{delimage:{name:"Borrar"},banimage:{name:"Banear"},cenimg:{name:"Censurar"},uncenimg:{name:"Descensurar"}}}}})}}(),"board"===urlocation?window.Echo.private("created.post").listen("PostCreated",(function(t){1===urstatus&&W(t)})):"search"===urlocation||window.Echo.private("created.comment.".concat(puid)).listen("PostCreated",(function(t){z(t).prependTo(cc)})),"board"===urlocation?(H(),$(window).scroll((function(t){var e=document.body,n=parseFloat(e.clientHeight)+60;e.scrollHeight-(this.pageYOffset||e.scrollTop)<=n&&H()}))):"search"===urlocation?W(publications):U(publication,comments),1===urstatus?information("Administrador"):3===urstatus&&information("Moderador"),D()}}.call(this,n(1),n(6)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";n.r(e),n.d(e,"defineEventAttribute",(function(){return v})),n.d(e,"EventTarget",(function(){return m}));const o=new WeakMap,i=new WeakMap;function r(t){const e=o.get(t);return console.assert(null!=e,"'this' is expected an Event object, but got",t),e}function s(t,e){o.set(this,{eventTarget:t,event:e,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,passiveListener:null,timeStamp:e.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=Object.keys(e);for(let t=0;t<n.length;++t){const e=n[t];e in this||Object.defineProperty(this,e,a(e))}}function a(t){return{get(){return r(this).event[t]},set(e){r(this).event[t]=e},configurable:!0,enumerable:!0}}function c(t){return{value(){const e=r(this).event;return e[t].apply(e,arguments)},configurable:!0,enumerable:!0}}function u(t){if(null==t||t===Object.prototype)return s;let e=i.get(t);return null==e&&(e=function(t,e){const n=Object.keys(e);if(0===n.length)return t;function o(e,n){t.call(this,e,n)}o.prototype=Object.create(t.prototype,{constructor:{value:o,configurable:!0,writable:!0}});for(let i=0;i<n.length;++i){const r=n[i];if(!(r in t.prototype)){const t="function"==typeof Object.getOwnPropertyDescriptor(e,r).value;Object.defineProperty(o.prototype,r,t?c(r):a(r))}}return o}(u(Object.getPrototypeOf(t)),t),i.set(t,e)),e}function l(t){return r(t).stopped}function h(t,e){r(t).passiveListener=e}s.prototype={get type(){return r(this).event.type},get target(){return r(this).eventTarget},get currentTarget(){return r(this).currentTarget},composedPath(){const t=r(this).currentTarget;return null==t?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return r(this).eventPhase},stopPropagation(){const t=r(this);"function"==typeof t.event.stopPropagation&&t.event.stopPropagation()},stopImmediatePropagation(){const t=r(this);t.stopped=!0,"function"==typeof t.event.stopImmediatePropagation&&t.event.stopImmediatePropagation()},get bubbles(){return Boolean(r(this).event.bubbles)},get cancelable(){return Boolean(r(this).event.cancelable)},preventDefault(){const t=r(this);null==t.passiveListener?t.event.cancelable&&(t.canceled=!0,"function"==typeof t.event.preventDefault&&t.event.preventDefault()):console.warn("Event#preventDefault() was called from a passive listener:",t.passiveListener)},get defaultPrevented(){return r(this).canceled},get composed(){return Boolean(r(this).event.composed)},get timeStamp(){return r(this).timeStamp}},Object.defineProperty(s.prototype,"constructor",{value:s,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(s.prototype,window.Event.prototype),i.set(window.Event.prototype,s));const p=new WeakMap;function d(t){return null!==t&&"object"==typeof t}function f(t){const e=p.get(t);if(null==e)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return e}function v(t,e){Object.defineProperty(t,"on"+e,function(t){return{get(){let e=f(this).get(t);for(;null!=e;){if(3===e.listenerType)return e.listener;e=e.next}return null},set(e){"function"==typeof e||d(e)||(e=null);const n=f(this);let o=null,i=n.get(t);for(;null!=i;)3===i.listenerType?null!==o?o.next=i.next:null!==i.next?n.set(t,i.next):n.delete(t):o=i,i=i.next;if(null!==e){const i={listener:e,listenerType:3,passive:!1,once:!1,next:null};null===o?n.set(t,i):o.next=i}},configurable:!0,enumerable:!0}}(e))}function y(t){function e(){m.call(this)}e.prototype=Object.create(m.prototype,{constructor:{value:e,configurable:!0,writable:!0}});for(let n=0;n<t.length;++n)v(e.prototype,t[n]);return e}function m(){if(!(this instanceof m)){if(1===arguments.length&&Array.isArray(arguments[0]))return y(arguments[0]);if(arguments.length>0){const t=new Array(arguments.length);for(let e=0;e<arguments.length;++e)t[e]=arguments[e];return y(t)}throw new TypeError("Cannot call a class as a function")}p.set(this,new Map)}m.prototype={addEventListener(t,e,n){if(null==e)return!1;if("function"!=typeof e&&!d(e))throw new TypeError("'listener' should be a function or an object.");const o=f(this),i=d(n),r=(i?Boolean(n.capture):Boolean(n))?1:2,s={listener:e,listenerType:r,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null};let a=o.get(t);if(void 0===a)return o.set(t,s),!0;let c=null;for(;null!=a;){if(a.listener===e&&a.listenerType===r)return!1;c=a,a=a.next}return c.next=s,!0},removeEventListener(t,e,n){if(null==e)return!1;const o=f(this),i=(d(n)?Boolean(n.capture):Boolean(n))?1:2;let r=null,s=o.get(t);for(;null!=s;){if(s.listener===e&&s.listenerType===i)return null!==r?r.next=s.next:null!==s.next?o.set(t,s.next):o.delete(t),!0;r=s,s=s.next}return!1},dispatchEvent(t){if(null==t||"string"!=typeof t.type)throw new TypeError('"event.type" should be a string.');const e=f(this),n=t.type;let o=e.get(n);if(null==o)return!0;const i=function(t,e){return new(u(Object.getPrototypeOf(e)))(t,e)}(this,t);let s=null;for(;null!=o;){if(o.once?null!==s?s.next=o.next:null!==o.next?e.set(n,o.next):e.delete(n):s=o,h(i,o.passive?o.listener:null),"function"==typeof o.listener)try{o.listener.call(this,i)}catch(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t)}else 3!==o.listenerType&&"function"==typeof o.listener.handleEvent&&o.listener.handleEvent(i);if(l(i))break;o=o.next}return h(i,null),function(t,e){r(t).eventPhase=e}(i,0),function(t,e){r(t).currentTarget=e}(i,null),!i.defaultPrevented}},Object.defineProperty(m.prototype,"constructor",{value:m,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(m.prototype,window.EventTarget.prototype),e.default=m},function(t,e,n){"use strict";(function(t){var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,i++)o[i]=r[s];return o};Object.defineProperty(e,"__esModule",{value:!0});var o=function(t,e,n){this.name=t,this.version=e,this.os=n};e.BrowserInfo=o;var i=function(e){this.version=e,this.name="node",this.os=t.platform};e.NodeInfo=i;var r=function(){this.bot=!0,this.name="bot",this.version=null,this.os=null};e.BotInfo=r;var s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],a=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function c(t){var e=""!==t&&s.reduce((function(e,n){var o=n[0],i=n[1];if(e)return e;var r=i.exec(t);return!!r&&[o,r]}),!1);if(!e)return null;var i=e[0],a=e[1];if("searchbot"===i)return new r;var c=a[1]&&a[1].split(/[._]/).slice(0,3);return c?c.length<3&&(c=n(c,function(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}(3-c.length))):c=[],new o(i,c.join("."),u(t))}function u(t){for(var e=0,n=a.length;e<n;e++){var o=a[e],i=o[0];if(o[1].test(t))return i}return null}function l(){return void 0!==t&&t.version?new i(t.version.slice(1)):null}e.detect=function(t){return t?c(t):"undefined"!=typeof navigator?c(navigator.userAgent):l()},e.parseUserAgent=c,e.detectOS=u,e.getNodeVersion=l}).call(this,n(9))},function(t,e){var n,o,i=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(t){o=s}}();var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&d())}function d(){if(!l){var t=a(p);l=!0;for(var e=u.length;e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,l=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||l||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var o;window,o=function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){void 0===t&&(t="="),this._paddingCharacter=t}return t.prototype.encodedLength=function(t){return this._paddingCharacter?(t+2)/3*4|0:(8*t+5)/6|0},t.prototype.encode=function(t){for(var e="",n=0;n<t.length-2;n+=3){var o=t[n]<<16|t[n+1]<<8|t[n+2];e+=this._encodeByte(o>>>18&63),e+=this._encodeByte(o>>>12&63),e+=this._encodeByte(o>>>6&63),e+=this._encodeByte(o>>>0&63)}var i=t.length-n;return i>0&&(o=t[n]<<16|(2===i?t[n+1]<<8:0),e+=this._encodeByte(o>>>18&63),e+=this._encodeByte(o>>>12&63),e+=2===i?this._encodeByte(o>>>6&63):this._paddingCharacter||"",e+=this._paddingCharacter||""),e},t.prototype.maxDecodedLength=function(t){return this._paddingCharacter?t/4*3|0:(6*t+7)/8|0},t.prototype.decodedLength=function(t){return this.maxDecodedLength(t.length-this._getPaddingLength(t))},t.prototype.decode=function(t){if(0===t.length)return new Uint8Array(0);for(var e=this._getPaddingLength(t),n=t.length-e,o=new Uint8Array(this.maxDecodedLength(n)),i=0,r=0,s=0,a=0,c=0,u=0,l=0;r<n-4;r+=4)a=this._decodeChar(t.charCodeAt(r+0)),c=this._decodeChar(t.charCodeAt(r+1)),u=this._decodeChar(t.charCodeAt(r+2)),l=this._decodeChar(t.charCodeAt(r+3)),o[i++]=a<<2|c>>>4,o[i++]=c<<4|u>>>2,o[i++]=u<<6|l,s|=256&a,s|=256&c,s|=256&u,s|=256&l;if(r<n-1&&(a=this._decodeChar(t.charCodeAt(r)),c=this._decodeChar(t.charCodeAt(r+1)),o[i++]=a<<2|c>>>4,s|=256&a,s|=256&c),r<n-2&&(u=this._decodeChar(t.charCodeAt(r+2)),o[i++]=c<<4|u>>>2,s|=256&u),r<n-3&&(l=this._decodeChar(t.charCodeAt(r+3)),o[i++]=u<<6|l,s|=256&l),0!==s)throw new Error("Base64Coder: incorrect characters for decoding");return o},t.prototype._encodeByte=function(t){var e=t;return e+=65,e+=25-t>>>8&6,e+=51-t>>>8&-75,e+=61-t>>>8&-15,e+=62-t>>>8&3,String.fromCharCode(e)},t.prototype._decodeChar=function(t){var e=256;return e+=(42-t&t-44)>>>8&-256+t-43+62,e+=(46-t&t-48)>>>8&-256+t-47+63,e+=(47-t&t-58)>>>8&-256+t-48+52,e+=(64-t&t-91)>>>8&-256+t-65+0,e+=(96-t&t-123)>>>8&-256+t-97+26},t.prototype._getPaddingLength=function(t){var e=0;if(this._paddingCharacter){for(var n=t.length-1;n>=0&&t[n]===this._paddingCharacter;n--)e++;if(t.length<4||e>2)throw new Error("Base64Coder: incorrect padding")}return e},t}();e.Coder=r;var s=new r;e.encode=function(t){return s.encode(t)},e.decode=function(t){return s.decode(t)};var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._encodeByte=function(t){var e=t;return e+=65,e+=25-t>>>8&6,e+=51-t>>>8&-75,e+=61-t>>>8&-13,e+=62-t>>>8&49,String.fromCharCode(e)},e.prototype._decodeChar=function(t){var e=256;return e+=(44-t&t-46)>>>8&-256+t-45+62,e+=(94-t&t-96)>>>8&-256+t-95+63,e+=(47-t&t-58)>>>8&-256+t-48+52,e+=(64-t&t-91)>>>8&-256+t-65+0,e+=(96-t&t-123)>>>8&-256+t-97+26},e}(r);e.URLSafeCoder=a;var c=new a;e.encodeURLSafe=function(t){return c.encode(t)},e.decodeURLSafe=function(t){return c.decode(t)},e.encodedLength=function(t){return s.encodedLength(t)},e.maxDecodedLength=function(t){return s.maxDecodedLength(t)},e.decodedLength=function(t){return s.decodedLength(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o="utf8: invalid source encoding";function i(t){for(var e=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);if(o<128)e+=1;else if(o<2048)e+=2;else if(o<55296)e+=3;else{if(!(o<=57343))throw new Error("utf8: invalid string");if(n>=t.length-1)throw new Error("utf8: invalid string");n++,e+=4}}return e}e.encode=function(t){for(var e=new Uint8Array(i(t)),n=0,o=0;o<t.length;o++){var r=t.charCodeAt(o);r<128?e[n++]=r:r<2048?(e[n++]=192|r>>6,e[n++]=128|63&r):r<55296?(e[n++]=224|r>>12,e[n++]=128|r>>6&63,e[n++]=128|63&r):(o++,r=(1023&r)<<10,r|=1023&t.charCodeAt(o),r+=65536,e[n++]=240|r>>18,e[n++]=128|r>>12&63,e[n++]=128|r>>6&63,e[n++]=128|63&r)}return e},e.encodedLength=i,e.decode=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];if(128&i){var r=void 0;if(i<224){if(n>=t.length)throw new Error(o);if(128!=(192&(s=t[++n])))throw new Error(o);i=(31&i)<<6|63&s,r=128}else if(i<240){if(n>=t.length-1)throw new Error(o);var s=t[++n],a=t[++n];if(128!=(192&s)||128!=(192&a))throw new Error(o);i=(15&i)<<12|(63&s)<<6|63&a,r=2048}else{if(!(i<248))throw new Error(o);if(n>=t.length-2)throw new Error(o);s=t[++n],a=t[++n];var c=t[++n];if(128!=(192&s)||128!=(192&a)||128!=(192&c))throw new Error(o);i=(15&i)<<18|(63&s)<<12|(63&a)<<6|63&c,r=65536}if(i<r||i>=55296&&i<=57343)throw new Error(o);if(i>=65536){if(i>1114111)throw new Error(o);i-=65536,e.push(String.fromCharCode(55296|i>>10)),i=56320|1023&i}}e.push(String.fromCharCode(i))}return e.join("")}},function(t,e,n){t.exports=n(3).default},function(t,e,n){"use strict";n.r(e);for(var o,i=function(){function t(t,e){this.lastId=0,this.prefix=t,this.name=e}return t.prototype.create=function(t){this.lastId++;var e=this.lastId,n=this.prefix+e,o=this.name+"["+e+"]",i=!1,r=function(){i||(t.apply(null,arguments),i=!0)};return this[e]=r,{number:e,id:n,name:o,callback:r}},t.prototype.remove=function(t){delete this[t.number]},t}(),r=new i("_pusher_script_","Pusher.ScriptReceivers"),s={VERSION:"7.0.2",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,cluster:"mt1",cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},a=function(){function t(t){this.options=t,this.receivers=t.receivers||r,this.loading={}}return t.prototype.load=function(t,e,n){var o=this;if(o.loading[t]&&o.loading[t].length>0)o.loading[t].push(n);else{o.loading[t]=[n];var i=ke.createScriptRequest(o.getPath(t,e)),r=o.receivers.create((function(e){if(o.receivers.remove(r),o.loading[t]){var n=o.loading[t];delete o.loading[t];for(var s=function(t){t||i.cleanup()},a=0;a<n.length;a++)n[a](e,s)}}));i.send(r)}},t.prototype.getRoot=function(t){var e=ke.getDocument().location.protocol;return(t&&t.useTLS||"https:"===e?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},t.prototype.getPath=function(t,e){return this.getRoot(e)+"/"+t+this.options.suffix+".js"},t}(),c=new i("_pusher_dependencies","Pusher.DependenciesReceivers"),u=new a({cdn_http:s.cdn_http,cdn_https:s.cdn_https,version:s.VERSION,suffix:s.dependency_suffix,receivers:c}),l={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/authenticating_users"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}},h=function(t){var e,n=l.urls[t];return n?(n.fullUrl?e=n.fullUrl:n.path&&(e=l.baseUrl+n.path),e?"See: "+e:""):""},p=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),f=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),v=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),y=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),m=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),g=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),b=function(t){function e(e){var n=this.constructor,o=t.call(this,e)||this;return Object.setPrototypeOf(o,n.prototype),o}return p(e,t),e}(Error),w=function(t){function e(e,n){var o=this.constructor,i=t.call(this,n)||this;return i.status=e,Object.setPrototypeOf(i,o.prototype),i}return p(e,t),e}(Error),k=function(t,e,n){var o,i=this;for(var r in(o=ke.createXHR()).open("POST",i.options.authEndpoint,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.authOptions.headers)o.setRequestHeader(r,this.authOptions.headers[r]);return o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var t=void 0,e=!1;try{t=JSON.parse(o.responseText),e=!0}catch(t){n(new w(200,"JSON returned from auth endpoint was invalid, yet status code was 200. Data was: "+o.responseText),{auth:""})}e&&n(null,t)}else{var r=h("authenticationEndpoint");n(new w(o.status,"Unable to retrieve auth string from auth endpoint - received status: "+o.status+" from "+i.options.authEndpoint+". Clients must be authenticated to join private or presence channels. "+r),{auth:""})}},o.send(this.composeQuery(e)),o},_=String.fromCharCode,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T={},O=0,C=S.length;O<C;O++)T[S.charAt(O)]=O;var P=function(t){var e=t.charCodeAt(0);return e<128?t:e<2048?_(192|e>>>6)+_(128|63&e):_(224|e>>>12&15)+_(128|e>>>6&63)+_(128|63&e)},E=function(t){return t.replace(/[^\x00-\x7F]/g,P)},x=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[S.charAt(n>>>18),S.charAt(n>>>12&63),e>=2?"=":S.charAt(n>>>6&63),e>=1?"=":S.charAt(63&n)].join("")},A=window.btoa||function(t){return t.replace(/[\s\S]{1,3}/g,x)},j=function(){function t(t,e,n,o){var i=this;this.clear=e,this.timer=t((function(){i.timer&&(i.timer=o(i.timer))}),n)}return t.prototype.isRunning=function(){return null!==this.timer},t.prototype.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},t}(),I=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function L(t){window.clearTimeout(t)}function R(t){window.clearInterval(t)}var M=function(t){function e(e,n){return t.call(this,setTimeout,L,e,(function(t){return n(),null}))||this}return I(e,t),e}(j),D=function(t){function e(e,n){return t.call(this,setInterval,R,e,(function(t){return n(),t}))||this}return I(e,t),e}(j),B={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(t){return new M(0,t)},method:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=Array.prototype.slice.call(arguments,1);return function(e){return e[t].apply(e,o.concat(arguments))}}};function N(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o=0;o<e.length;o++){var i=e[o];for(var r in i)i[r]&&i[r].constructor&&i[r].constructor===Object?t[r]=N(t[r]||{},i[r]):t[r]=i[r]}return t}function $(){for(var t=["Pusher"],e=0;e<arguments.length;e++)"string"==typeof arguments[e]?t.push(arguments[e]):t.push(Q(arguments[e]));return t.join(" : ")}function W(t,e){var n=Array.prototype.indexOf;if(null===t)return-1;if(n&&t.indexOf===n)return t.indexOf(e);for(var o=0,i=t.length;o<i;o++)if(t[o]===e)return o;return-1}function H(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(t[n],n,t)}function z(t){var e=[];return H(t,(function(t,n){e.push(n)})),e}function U(t,e,n){for(var o=0;o<t.length;o++)e.call(n||window,t[o],o,t)}function F(t,e){for(var n=[],o=0;o<t.length;o++)n.push(e(t[o],o,t,n));return n}function q(t,e){e=e||function(t){return!!t};for(var n=[],o=0;o<t.length;o++)e(t[o],o,t,n)&&n.push(t[o]);return n}function X(t,e){var n={};return H(t,(function(o,i){(e&&e(o,i,t,n)||Boolean(o))&&(n[i]=o)})),n}function V(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1}function J(t){return e=function(t){return"object"==typeof t&&(t=Q(t)),encodeURIComponent((e=t.toString(),A(E(e))));var e},n={},H(t,(function(t,o){n[o]=e(t)})),n;var e,n}function G(t){var e,n,o=X(t,(function(t){return void 0!==t}));return F((e=J(o),n=[],H(e,(function(t,e){n.push([e,t])})),n),B.method("join","=")).join("&")}function Q(t){try{return JSON.stringify(t)}catch(o){return JSON.stringify((e=[],n=[],function t(o,i){var r,s,a;switch(typeof o){case"object":if(!o)return null;for(r=0;r<e.length;r+=1)if(e[r]===o)return{$ref:n[r]};if(e.push(o),n.push(i),"[object Array]"===Object.prototype.toString.apply(o))for(a=[],r=0;r<o.length;r+=1)a[r]=t(o[r],i+"["+r+"]");else for(s in a={},o)Object.prototype.hasOwnProperty.call(o,s)&&(a[s]=t(o[s],i+"["+JSON.stringify(s)+"]"));return a;case"number":case"string":case"boolean":return o}}(t,"$")))}var e,n}var K=new(function(){function t(){this.globalLog=function(t){window.console&&window.console.log&&window.console.log(t)}}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(this.globalLog,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(this.globalLogWarn,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.log(this.globalLogError,t)},t.prototype.globalLogWarn=function(t){window.console&&window.console.warn?window.console.warn(t):this.globalLog(t)},t.prototype.globalLogError=function(t){window.console&&window.console.error?window.console.error(t):this.globalLogWarn(t)},t.prototype.log=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=$.apply(this,arguments);if(Me.log)Me.log(o);else if(Me.logToConsole){var i=t.bind(this);i(o)}},t}()),Y=function(t,e,n){void 0!==this.authOptions.headers&&K.warn("To send headers with the auth request, you must use AJAX, rather than JSONP.");var o=t.nextAuthCallbackID.toString();t.nextAuthCallbackID++;var i=t.getDocument(),r=i.createElement("script");t.auth_callbacks[o]=function(t){n(null,t)};var s="Pusher.auth_callbacks['"+o+"']";r.src=this.options.authEndpoint+"?callback="+encodeURIComponent(s)+"&"+this.composeQuery(e);var a=i.getElementsByTagName("head")[0]||i.documentElement;a.insertBefore(r,a.firstChild)},Z=function(){function t(t){this.src=t}return t.prototype.send=function(t){var e=this,n="Error loading "+e.src;e.script=document.createElement("script"),e.script.id=t.id,e.script.src=e.src,e.script.type="text/javascript",e.script.charset="UTF-8",e.script.addEventListener?(e.script.onerror=function(){t.callback(n)},e.script.onload=function(){t.callback(null)}):e.script.onreadystatechange=function(){"loaded"!==e.script.readyState&&"complete"!==e.script.readyState||t.callback(null)},void 0===e.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(e.errorScript=document.createElement("script"),e.errorScript.id=t.id+"_error",e.errorScript.text=t.name+"('"+n+"');",e.script.async=e.errorScript.async=!1):e.script.async=!0;var o=document.getElementsByTagName("head")[0];o.insertBefore(e.script,o.firstChild),e.errorScript&&o.insertBefore(e.errorScript,e.script.nextSibling)},t.prototype.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null},t}(),tt=function(){function t(t,e){this.url=t,this.data=e}return t.prototype.send=function(t){if(!this.request){var e=G(this.data),n=this.url+"/"+t.number+"?"+e;this.request=ke.createScriptRequest(n),this.request.send(t)}},t.prototype.cleanup=function(){this.request&&this.request.cleanup()},t}(),et={name:"jsonp",getAgent:function(t,e){return function(n,o){var i="http"+(e?"s":"")+"://"+(t.host||t.options.host)+t.options.path,s=ke.createJSONPRequest(i,n),a=ke.ScriptReceivers.create((function(e,n){r.remove(a),s.cleanup(),n&&n.host&&(t.host=n.host),o&&o(e,n)}));s.send(a)}}};function nt(t,e,n){return t+(e.useTLS?"s":"")+"://"+(e.useTLS?e.hostTLS:e.hostNonTLS)+n}function ot(t,e){return"/app/"+t+"?protocol="+s.PROTOCOL+"&client=js&version="+s.VERSION+(e?"&"+e:"")}var it={getInitial:function(t,e){return nt("ws",e,(e.httpPath||"")+ot(t,"flash=false"))}},rt={getInitial:function(t,e){return nt("http",e,(e.httpPath||"/pusher")+ot(t))}},st={getInitial:function(t,e){return nt("http",e,e.httpPath||"/pusher")},getPath:function(t,e){return ot(t)}},at=function(){function t(){this._callbacks={}}return t.prototype.get=function(t){return this._callbacks[ct(t)]},t.prototype.add=function(t,e,n){var o=ct(t);this._callbacks[o]=this._callbacks[o]||[],this._callbacks[o].push({fn:e,context:n})},t.prototype.remove=function(t,e,n){if(t||e||n){var o=t?[ct(t)]:z(this._callbacks);e||n?this.removeCallback(o,e,n):this.removeAllCallbacks(o)}else this._callbacks={}},t.prototype.removeCallback=function(t,e,n){U(t,(function(t){this._callbacks[t]=q(this._callbacks[t]||[],(function(t){return e&&e!==t.fn||n&&n!==t.context})),0===this._callbacks[t].length&&delete this._callbacks[t]}),this)},t.prototype.removeAllCallbacks=function(t){U(t,(function(t){delete this._callbacks[t]}),this)},t}();function ct(t){return"_"+t}var ut=function(){function t(t){this.callbacks=new at,this.global_callbacks=[],this.failThrough=t}return t.prototype.bind=function(t,e,n){return this.callbacks.add(t,e,n),this},t.prototype.bind_global=function(t){return this.global_callbacks.push(t),this},t.prototype.unbind=function(t,e,n){return this.callbacks.remove(t,e,n),this},t.prototype.unbind_global=function(t){return t?(this.global_callbacks=q(this.global_callbacks||[],(function(e){return e!==t})),this):(this.global_callbacks=[],this)},t.prototype.unbind_all=function(){return this.unbind(),this.unbind_global(),this},t.prototype.emit=function(t,e,n){for(var o=0;o<this.global_callbacks.length;o++)this.global_callbacks[o](t,e);var i=this.callbacks.get(t),r=[];if(n?r.push(e,n):e&&r.push(e),i&&i.length>0)for(o=0;o<i.length;o++)i[o].fn.apply(i[o].context||window,r);else this.failThrough&&this.failThrough(t,e);return this},t}(),lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ht=function(t){function e(e,n,o,i,r){var s=t.call(this)||this;return s.initialize=ke.transportConnectionInitializer,s.hooks=e,s.name=n,s.priority=o,s.key=i,s.options=r,s.state="new",s.timeline=r.timeline,s.activityTimeout=r.activityTimeout,s.id=s.timeline.generateUniqueID(),s}return lt(e,t),e.prototype.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},e.prototype.supportsPing=function(){return Boolean(this.hooks.supportsPing)},e.prototype.connect=function(){var t=this;if(this.socket||"initialized"!==this.state)return!1;var e=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(e,this.options)}catch(e){return B.defer((function(){t.onError(e),t.changeState("closed")})),!1}return this.bindListeners(),K.debug("Connecting",{transport:this.name,url:e}),this.changeState("connecting"),!0},e.prototype.close=function(){return!!this.socket&&(this.socket.close(),!0)},e.prototype.send=function(t){var e=this;return"open"===this.state&&(B.defer((function(){e.socket&&e.socket.send(t)})),!0)},e.prototype.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},e.prototype.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},e.prototype.onError=function(t){this.emit("error",{type:"WebSocketError",error:t}),this.timeline.error(this.buildTimelineMessage({error:t.toString()}))},e.prototype.onClose=function(t){t?this.changeState("closed",{code:t.code,reason:t.reason,wasClean:t.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},e.prototype.onMessage=function(t){this.emit("message",t)},e.prototype.onActivity=function(){this.emit("activity")},e.prototype.bindListeners=function(){var t=this;this.socket.onopen=function(){t.onOpen()},this.socket.onerror=function(e){t.onError(e)},this.socket.onclose=function(e){t.onClose(e)},this.socket.onmessage=function(e){t.onMessage(e)},this.supportsPing()&&(this.socket.onactivity=function(){t.onActivity()})},e.prototype.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},e.prototype.changeState=function(t,e){this.state=t,this.timeline.info(this.buildTimelineMessage({state:t,params:e})),this.emit(t,e)},e.prototype.buildTimelineMessage=function(t){return N({cid:this.id},t)},e}(ut),pt=function(){function t(t){this.hooks=t}return t.prototype.isSupported=function(t){return this.hooks.isSupported(t)},t.prototype.createConnection=function(t,e,n,o){return new ht(this.hooks,t,e,n,o)},t}(),dt=new pt({urls:it,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(ke.getWebSocketAPI())},isSupported:function(){return Boolean(ke.getWebSocketAPI())},getSocket:function(t){return ke.createWebSocket(t)}}),ft={urls:rt,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},vt=N({getSocket:function(t){return ke.HTTPFactory.createStreamingSocket(t)}},ft),yt=N({getSocket:function(t){return ke.HTTPFactory.createPollingSocket(t)}},ft),mt={isSupported:function(){return ke.isXHRSupported()}},gt={ws:dt,xhr_streaming:new pt(N({},vt,mt)),xhr_polling:new pt(N({},yt,mt))},bt=new pt({file:"sockjs",urls:st,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(t,e){return new window.SockJS(t,null,{js_path:u.getPath("sockjs",{useTLS:e.useTLS}),ignore_null_origin:e.ignoreNullOrigin})},beforeOpen:function(t,e){t.send(JSON.stringify({path:e}))}}),wt={isSupported:function(t){return ke.isXDRSupported(t.useTLS)}},kt=new pt(N({},vt,wt)),_t=new pt(N({},yt,wt));gt.xdr_streaming=kt,gt.xdr_polling=_t,gt.sockjs=bt;var St=gt,Tt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ot=new(function(t){function e(){var e=t.call(this)||this,n=e;return void 0!==window.addEventListener&&(window.addEventListener("online",(function(){n.emit("online")}),!1),window.addEventListener("offline",(function(){n.emit("offline")}),!1)),e}return Tt(e,t),e.prototype.isOnline=function(){return void 0===window.navigator.onLine||window.navigator.onLine},e}(ut)),Ct=function(){function t(t,e,n){this.manager=t,this.transport=e,this.minPingDelay=n.minPingDelay,this.maxPingDelay=n.maxPingDelay,this.pingDelay=void 0}return t.prototype.createConnection=function(t,e,n,o){var i=this;o=N({},o,{activityTimeout:this.pingDelay});var r=this.transport.createConnection(t,e,n,o),s=null,a=function(){r.unbind("open",a),r.bind("closed",c),s=B.now()},c=function(t){if(r.unbind("closed",c),1002===t.code||1003===t.code)i.manager.reportDeath();else if(!t.wasClean&&s){var e=B.now()-s;e<2*i.maxPingDelay&&(i.manager.reportDeath(),i.pingDelay=Math.max(e/2,i.minPingDelay))}};return r.bind("open",a),r},t.prototype.isSupported=function(t){return this.manager.isAlive()&&this.transport.isSupported(t)},t}(),Pt={decodeMessage:function(t){try{var e=JSON.parse(t.data),n=e.data;if("string"==typeof n)try{n=JSON.parse(e.data)}catch(t){}var o={event:e.event,channel:e.channel,data:n};return e.user_id&&(o.user_id=e.user_id),o}catch(e){throw{type:"MessageParseError",error:e,data:t.data}}},encodeMessage:function(t){return JSON.stringify(t)},processHandshake:function(t){var e=Pt.decodeMessage(t);if("pusher:connection_established"===e.event){if(!e.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:e.data.socket_id,activityTimeout:1e3*e.data.activity_timeout}}if("pusher:error"===e.event)return{action:this.getCloseAction(e.data),error:this.getCloseError(e.data)};throw"Invalid handshake"},getCloseAction:function(t){return t.code<4e3?t.code>=1002&&t.code<=1004?"backoff":null:4e3===t.code?"tls_only":t.code<4100?"refused":t.code<4200?"backoff":t.code<4300?"retry":"refused"},getCloseError:function(t){return 1e3!==t.code&&1001!==t.code?{type:"PusherError",data:{code:t.code,message:t.reason||t.message}}:null}},Et=Pt,xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),At=function(t){function e(e,n){var o=t.call(this)||this;return o.id=e,o.transport=n,o.activityTimeout=n.activityTimeout,o.bindListeners(),o}return xt(e,t),e.prototype.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},e.prototype.send=function(t){return this.transport.send(t)},e.prototype.send_event=function(t,e,n){var o={event:t,data:e};return n&&(o.channel=n),K.debug("Event sent",o),this.send(Et.encodeMessage(o))},e.prototype.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},e.prototype.close=function(){this.transport.close()},e.prototype.bindListeners=function(){var t=this,e={message:function(e){var n;try{n=Et.decodeMessage(e)}catch(n){t.emit("error",{type:"MessageParseError",error:n,data:e.data})}if(void 0!==n){switch(K.debug("Event recd",n),n.event){case"pusher:error":t.emit("error",{type:"PusherError",data:n.data});break;case"pusher:ping":t.emit("ping");break;case"pusher:pong":t.emit("pong")}t.emit("message",n)}},activity:function(){t.emit("activity")},error:function(e){t.emit("error",e)},closed:function(e){n(),e&&e.code&&t.handleCloseEvent(e),t.transport=null,t.emit("closed")}},n=function(){H(e,(function(e,n){t.transport.unbind(n,e)}))};H(e,(function(e,n){t.transport.bind(n,e)}))},e.prototype.handleCloseEvent=function(t){var e=Et.getCloseAction(t),n=Et.getCloseError(t);n&&this.emit("error",n),e&&this.emit(e,{action:e,error:n})},e}(ut),jt=function(){function t(t,e){this.transport=t,this.callback=e,this.bindListeners()}return t.prototype.close=function(){this.unbindListeners(),this.transport.close()},t.prototype.bindListeners=function(){var t=this;this.onMessage=function(e){var n;t.unbindListeners();try{n=Et.processHandshake(e)}catch(e){return t.finish("error",{error:e}),void t.transport.close()}"connected"===n.action?t.finish("connected",{connection:new At(n.id,t.transport),activityTimeout:n.activityTimeout}):(t.finish(n.action,{error:n.error}),t.transport.close())},this.onClosed=function(e){t.unbindListeners();var n=Et.getCloseAction(e)||"backoff",o=Et.getCloseError(e);t.finish(n,{error:o})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)},t.prototype.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},t.prototype.finish=function(t,e){this.callback(N({transport:this.transport,action:t},e))},t}(),It=function(){function t(t,e){this.channel=t;var n=e.authTransport;if(void 0===ke.getAuthorizers()[n])throw"'"+n+"' is not a recognized auth transport";this.type=n,this.options=e,this.authOptions=e.auth||{}}return t.prototype.composeQuery=function(t){var e="socket_id="+encodeURIComponent(t)+"&channel_name="+encodeURIComponent(this.channel.name);for(var n in this.authOptions.params)e+="&"+encodeURIComponent(n)+"="+encodeURIComponent(this.authOptions.params[n]);return e},t.prototype.authorize=function(e,n){t.authorizers=t.authorizers||ke.getAuthorizers(),t.authorizers[this.type].call(this,ke,e,n)},t}(),Lt=function(){function t(t,e){this.timeline=t,this.options=e||{}}return t.prototype.send=function(t,e){this.timeline.isEmpty()||this.timeline.send(ke.TimelineTransport.getAgent(this,t),e)},t}(),Rt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Mt=function(t){function e(e,n){var o=t.call(this,(function(t,n){K.debug("No callbacks on "+e+" for "+t)}))||this;return o.name=e,o.pusher=n,o.subscribed=!1,o.subscriptionPending=!1,o.subscriptionCancelled=!1,o}return Rt(e,t),e.prototype.authorize=function(t,e){return e(null,{auth:""})},e.prototype.trigger=function(t,e){if(0!==t.indexOf("client-"))throw new d("Event '"+t+"' does not start with 'client-'");if(!this.subscribed){var n=h("triggeringClientEvents");K.warn("Client event triggered before channel 'subscription_succeeded' event . "+n)}return this.pusher.send_event(t,e,this.name)},e.prototype.disconnect=function(){this.subscribed=!1,this.subscriptionPending=!1},e.prototype.handleEvent=function(t){var e=t.event,n=t.data;"pusher_internal:subscription_succeeded"===e?this.handleSubscriptionSucceededEvent(t):0!==e.indexOf("pusher_internal:")&&this.emit(e,n,{})},e.prototype.handleSubscriptionSucceededEvent=function(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",t.data)},e.prototype.subscribe=function(){var t=this;this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(function(e,n){e?(t.subscriptionPending=!1,K.error(e.toString()),t.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:e.message},e instanceof w?{status:e.status}:{}))):t.pusher.send_event("pusher:subscribe",{auth:n.auth,channel_data:n.channel_data,channel:t.name})})))},e.prototype.unsubscribe=function(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},e.prototype.cancelSubscription=function(){this.subscriptionCancelled=!0},e.prototype.reinstateSubscription=function(){this.subscriptionCancelled=!1},e}(ut),Dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dt(e,t),e.prototype.authorize=function(t,e){return Jt.createAuthorizer(this,this.pusher.config).authorize(t,e)},e}(Mt),Nt=function(){function t(){this.reset()}return t.prototype.get=function(t){return Object.prototype.hasOwnProperty.call(this.members,t)?{id:t,info:this.members[t]}:null},t.prototype.each=function(t){var e=this;H(this.members,(function(n,o){t(e.get(o))}))},t.prototype.setMyID=function(t){this.myID=t},t.prototype.onSubscription=function(t){this.members=t.presence.hash,this.count=t.presence.count,this.me=this.get(this.myID)},t.prototype.addMember=function(t){return null===this.get(t.user_id)&&this.count++,this.members[t.user_id]=t.user_info,this.get(t.user_id)},t.prototype.removeMember=function(t){var e=this.get(t.user_id);return e&&(delete this.members[t.user_id],this.count--),e},t.prototype.reset=function(){this.members={},this.count=0,this.myID=null,this.me=null},t}(),$t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Wt=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.members=new Nt,o}return $t(e,t),e.prototype.authorize=function(e,n){var o=this;t.prototype.authorize.call(this,e,(function(t,e){if(!t){if(void 0===(e=e).channel_data){var i=h("authenticationEndpoint");return K.error("Invalid auth response for channel '"+o.name+"',expected 'channel_data' field. "+i),void n("Invalid auth response")}var r=JSON.parse(e.channel_data);o.members.setMyID(r.user_id)}n(t,e)}))},e.prototype.handleEvent=function(t){var e=t.event;if(0===e.indexOf("pusher_internal:"))this.handleInternalEvent(t);else{var n=t.data,o={};t.user_id&&(o.user_id=t.user_id),this.emit(e,n,o)}},e.prototype.handleInternalEvent=function(t){var e=t.event,n=t.data;switch(e){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(t);break;case"pusher_internal:member_added":var o=this.members.addMember(n);this.emit("pusher:member_added",o);break;case"pusher_internal:member_removed":var i=this.members.removeMember(n);i&&this.emit("pusher:member_removed",i)}},e.prototype.handleSubscriptionSucceededEvent=function(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(t.data),this.emit("pusher:subscription_succeeded",this.members))},e.prototype.disconnect=function(){this.members.reset(),t.prototype.disconnect.call(this)},e}(Bt),Ht=n(1),zt=n(0),Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ft=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i.key=null,i.nacl=o,i}return Ut(e,t),e.prototype.authorize=function(e,n){var o=this;t.prototype.authorize.call(this,e,(function(t,e){if(t)n(t,e);else{var i=e.shared_secret;i?(o.key=Object(zt.decode)(i),delete e.shared_secret,n(null,e)):n(new Error("No shared_secret key in auth payload for encrypted channel: "+o.name),null)}}))},e.prototype.trigger=function(t,e){throw new m("Client events are not currently supported for encrypted channels")},e.prototype.handleEvent=function(e){var n=e.event,o=e.data;0!==n.indexOf("pusher_internal:")&&0!==n.indexOf("pusher:")?this.handleEncryptedEvent(n,o):t.prototype.handleEvent.call(this,e)},e.prototype.handleEncryptedEvent=function(t,e){var n=this;if(this.key)if(e.ciphertext&&e.nonce){var o=Object(zt.decode)(e.ciphertext);if(o.length<this.nacl.secretbox.overheadLength)K.error("Expected encrypted event ciphertext length to be "+this.nacl.secretbox.overheadLength+", got: "+o.length);else{var i=Object(zt.decode)(e.nonce);if(i.length<this.nacl.secretbox.nonceLength)K.error("Expected encrypted event nonce length to be "+this.nacl.secretbox.nonceLength+", got: "+i.length);else{var r=this.nacl.secretbox.open(o,i,this.key);if(null===r)return K.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),void this.authorize(this.pusher.connection.socket_id,(function(e,s){e?K.error("Failed to make a request to the authEndpoint: "+s+". Unable to fetch new key, so dropping encrypted event"):null!==(r=n.nacl.secretbox.open(o,i,n.key))?n.emit(t,n.getDataToEmit(r)):K.error("Failed to decrypt event with new key. Dropping encrypted event")}));this.emit(t,this.getDataToEmit(r))}}}else K.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+e);else K.debug("Received encrypted event before key has been retrieved from the authEndpoint")},e.prototype.getDataToEmit=function(t){var e=Object(Ht.decode)(t);try{return JSON.parse(e)}catch(t){return e}},e}(Bt),qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Xt=function(t){function e(e,n){var o=t.call(this)||this;o.state="initialized",o.connection=null,o.key=e,o.options=n,o.timeline=o.options.timeline,o.usingTLS=o.options.useTLS,o.errorCallbacks=o.buildErrorCallbacks(),o.connectionCallbacks=o.buildConnectionCallbacks(o.errorCallbacks),o.handshakeCallbacks=o.buildHandshakeCallbacks(o.errorCallbacks);var i=ke.getNetwork();return i.bind("online",(function(){o.timeline.info({netinfo:"online"}),"connecting"!==o.state&&"unavailable"!==o.state||o.retryIn(0)})),i.bind("offline",(function(){o.timeline.info({netinfo:"offline"}),o.connection&&o.sendActivityCheck()})),o.updateStrategy(),o}return qt(e,t),e.prototype.connect=function(){this.connection||this.runner||(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},e.prototype.send=function(t){return!!this.connection&&this.connection.send(t)},e.prototype.send_event=function(t,e,n){return!!this.connection&&this.connection.send_event(t,e,n)},e.prototype.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},e.prototype.isUsingTLS=function(){return this.usingTLS},e.prototype.startConnecting=function(){var t=this,e=function(n,o){n?t.runner=t.strategy.connect(0,e):"error"===o.action?(t.emit("error",{type:"HandshakeError",error:o.error}),t.timeline.error({handshakeError:o.error})):(t.abortConnecting(),t.handshakeCallbacks[o.action](o))};this.runner=this.strategy.connect(0,e)},e.prototype.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},e.prototype.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()},e.prototype.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})},e.prototype.retryIn=function(t){var e=this;this.timeline.info({action:"retry",delay:t}),t>0&&this.emit("connecting_in",Math.round(t/1e3)),this.retryTimer=new M(t||0,(function(){e.disconnectInternally(),e.connect()}))},e.prototype.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},e.prototype.setUnavailableTimer=function(){var t=this;this.unavailableTimer=new M(this.options.unavailableTimeout,(function(){t.updateState("unavailable")}))},e.prototype.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},e.prototype.sendActivityCheck=function(){var t=this;this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new M(this.options.pongTimeout,(function(){t.timeline.error({pong_timed_out:t.options.pongTimeout}),t.retryIn(0)}))},e.prototype.resetActivityCheck=function(){var t=this;this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new M(this.activityTimeout,(function(){t.sendActivityCheck()})))},e.prototype.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},e.prototype.buildConnectionCallbacks=function(t){var e=this;return N({},t,{message:function(t){e.resetActivityCheck(),e.emit("message",t)},ping:function(){e.send_event("pusher:pong",{})},activity:function(){e.resetActivityCheck()},error:function(t){e.emit("error",t)},closed:function(){e.abandonConnection(),e.shouldRetry()&&e.retryIn(1e3)}})},e.prototype.buildHandshakeCallbacks=function(t){var e=this;return N({},t,{connected:function(t){e.activityTimeout=Math.min(e.options.activityTimeout,t.activityTimeout,t.connection.activityTimeout||1/0),e.clearUnavailableTimer(),e.setConnection(t.connection),e.socket_id=e.connection.id,e.updateState("connected",{socket_id:e.socket_id})}})},e.prototype.buildErrorCallbacks=function(){var t=this,e=function(e){return function(n){n.error&&t.emit("error",{type:"WebSocketError",error:n.error}),e(n)}};return{tls_only:e((function(){t.usingTLS=!0,t.updateStrategy(),t.retryIn(0)})),refused:e((function(){t.disconnect()})),backoff:e((function(){t.retryIn(1e3)})),retry:e((function(){t.retryIn(0)}))}},e.prototype.setConnection=function(t){for(var e in this.connection=t,this.connectionCallbacks)this.connection.bind(e,this.connectionCallbacks[e]);this.resetActivityCheck()},e.prototype.abandonConnection=function(){if(this.connection){for(var t in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(t,this.connectionCallbacks[t]);var e=this.connection;return this.connection=null,e}},e.prototype.updateState=function(t,e){var n=this.state;if(this.state=t,n!==t){var o=t;"connected"===o&&(o+=" with new socket ID "+e.socket_id),K.debug("State changed",n+" -> "+o),this.timeline.info({state:t,params:e}),this.emit("state_change",{previous:n,current:t}),this.emit(t,e)}},e.prototype.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},e}(ut),Vt=function(){function t(){this.channels={}}return t.prototype.add=function(t,e){return this.channels[t]||(this.channels[t]=function(t,e){if(0===t.indexOf("private-encrypted-")){if(e.config.nacl)return Jt.createEncryptedChannel(t,e,e.config.nacl);var n=h("encryptedChannelSupport");throw new m("Tried to subscribe to a private-encrypted- channel but no nacl implementation available. "+n)}return 0===t.indexOf("private-")?Jt.createPrivateChannel(t,e):0===t.indexOf("presence-")?Jt.createPresenceChannel(t,e):Jt.createChannel(t,e)}(t,e)),this.channels[t]},t.prototype.all=function(){return function(t){var e=[];return H(t,(function(t){e.push(t)})),e}(this.channels)},t.prototype.find=function(t){return this.channels[t]},t.prototype.remove=function(t){var e=this.channels[t];return delete this.channels[t],e},t.prototype.disconnect=function(){H(this.channels,(function(t){t.disconnect()}))},t}(),Jt={createChannels:function(){return new Vt},createConnectionManager:function(t,e){return new Xt(t,e)},createChannel:function(t,e){return new Mt(t,e)},createPrivateChannel:function(t,e){return new Bt(t,e)},createPresenceChannel:function(t,e){return new Wt(t,e)},createEncryptedChannel:function(t,e,n){return new Ft(t,e,n)},createTimelineSender:function(t,e){return new Lt(t,e)},createAuthorizer:function(t,e){return e.authorizer?e.authorizer(t,e):new It(t,e)},createHandshake:function(t,e){return new jt(t,e)},createAssistantToTheTransportManager:function(t,e,n){return new Ct(t,e,n)}},Gt=function(){function t(t){this.options=t||{},this.livesLeft=this.options.lives||1/0}return t.prototype.getAssistant=function(t){return Jt.createAssistantToTheTransportManager(this,t,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},t.prototype.isAlive=function(){return this.livesLeft>0},t.prototype.reportDeath=function(){this.livesLeft-=1},t}(),Qt=function(){function t(t,e){this.strategies=t,this.loop=Boolean(e.loop),this.failFast=Boolean(e.failFast),this.timeout=e.timeout,this.timeoutLimit=e.timeoutLimit}return t.prototype.isSupported=function(){return V(this.strategies,B.method("isSupported"))},t.prototype.connect=function(t,e){var n=this,o=this.strategies,i=0,r=this.timeout,s=null,a=function(c,u){u?e(null,u):(i+=1,n.loop&&(i%=o.length),i<o.length?(r&&(r*=2,n.timeoutLimit&&(r=Math.min(r,n.timeoutLimit))),s=n.tryStrategy(o[i],t,{timeout:r,failFast:n.failFast},a)):e(!0))};return s=this.tryStrategy(o[i],t,{timeout:r,failFast:this.failFast},a),{abort:function(){s.abort()},forceMinPriority:function(e){t=e,s&&s.forceMinPriority(e)}}},t.prototype.tryStrategy=function(t,e,n,o){var i=null,r=null;return n.timeout>0&&(i=new M(n.timeout,(function(){r.abort(),o(!0)}))),r=t.connect(e,(function(t,e){t&&i&&i.isRunning()&&!n.failFast||(i&&i.ensureAborted(),o(t,e))})),{abort:function(){i&&i.ensureAborted(),r.abort()},forceMinPriority:function(t){r.forceMinPriority(t)}}},t}(),Kt=function(){function t(t){this.strategies=t}return t.prototype.isSupported=function(){return V(this.strategies,B.method("isSupported"))},t.prototype.connect=function(t,e){return function(t,e,n){var o=F(t,(function(t,o,i,r){return t.connect(e,n(o,r))}));return{abort:function(){U(o,Yt)},forceMinPriority:function(t){U(o,(function(e){e.forceMinPriority(t)}))}}}(this.strategies,t,(function(t,n){return function(o,i){n[t].error=o,o?function(t){return function(t,e){for(var n=0;n<t.length;n++)if(!e(t[n],n,t))return!1;return!0}(t,(function(t){return Boolean(t.error)}))}(n)&&e(!0):(U(n,(function(t){t.forceMinPriority(i.transport.priority)})),e(null,i))}}))},t}();function Yt(t){t.error||t.aborted||(t.abort(),t.aborted=!0)}var Zt=function(){function t(t,e,n){this.strategy=t,this.transports=e,this.ttl=n.ttl||18e5,this.usingTLS=n.useTLS,this.timeline=n.timeline}return t.prototype.isSupported=function(){return this.strategy.isSupported()},t.prototype.connect=function(t,e){var n=this.usingTLS,o=function(t){var e=ke.getLocalStorage();if(e)try{var n=e[te(t)];if(n)return JSON.parse(n)}catch(e){ee(t)}return null}(n),i=[this.strategy];if(o&&o.timestamp+this.ttl>=B.now()){var r=this.transports[o.transport];r&&(this.timeline.info({cached:!0,transport:o.transport,latency:o.latency}),i.push(new Qt([r],{timeout:2*o.latency+1e3,failFast:!0})))}var s=B.now(),a=i.pop().connect(t,(function o(r,c){r?(ee(n),i.length>0?(s=B.now(),a=i.pop().connect(t,o)):e(r)):(function(t,e,n){var o=ke.getLocalStorage();if(o)try{o[te(t)]=Q({timestamp:B.now(),transport:e,latency:n})}catch(t){}}(n,c.transport.name,B.now()-s),e(null,c))}));return{abort:function(){a.abort()},forceMinPriority:function(e){t=e,a&&a.forceMinPriority(e)}}},t}();function te(t){return"pusherTransport"+(t?"TLS":"NonTLS")}function ee(t){var e=ke.getLocalStorage();if(e)try{delete e[te(t)]}catch(t){}}var ne=function(){function t(t,e){var n=e.delay;this.strategy=t,this.options={delay:n}}return t.prototype.isSupported=function(){return this.strategy.isSupported()},t.prototype.connect=function(t,e){var n,o=this.strategy,i=new M(this.options.delay,(function(){n=o.connect(t,e)}));return{abort:function(){i.ensureAborted(),n&&n.abort()},forceMinPriority:function(e){t=e,n&&n.forceMinPriority(e)}}},t}(),oe=function(){function t(t,e,n){this.test=t,this.trueBranch=e,this.falseBranch=n}return t.prototype.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},t.prototype.connect=function(t,e){return(this.test()?this.trueBranch:this.falseBranch).connect(t,e)},t}(),ie=function(){function t(t){this.strategy=t}return t.prototype.isSupported=function(){return this.strategy.isSupported()},t.prototype.connect=function(t,e){var n=this.strategy.connect(t,(function(t,o){o&&n.abort(),e(t,o)}));return n},t}();function re(t){return function(){return t.isSupported()}}var se,ae=function(t,e,n){var o={};function i(e,i,r,s,a){var c=n(t,e,i,r,s,a);return o[e]=c,c}var r,s=Object.assign({},e,{hostNonTLS:t.wsHost+":"+t.wsPort,hostTLS:t.wsHost+":"+t.wssPort,httpPath:t.wsPath}),a=Object.assign({},s,{useTLS:!0}),c=Object.assign({},e,{hostNonTLS:t.httpHost+":"+t.httpPort,hostTLS:t.httpHost+":"+t.httpsPort,httpPath:t.httpPath}),u={loop:!0,timeout:15e3,timeoutLimit:6e4},l=new Gt({lives:2,minPingDelay:1e4,maxPingDelay:t.activityTimeout}),h=new Gt({lives:2,minPingDelay:1e4,maxPingDelay:t.activityTimeout}),p=i("ws","ws",3,s,l),d=i("wss","ws",3,a,l),f=i("sockjs","sockjs",1,c),v=i("xhr_streaming","xhr_streaming",1,c,h),y=i("xdr_streaming","xdr_streaming",1,c,h),m=i("xhr_polling","xhr_polling",1,c),g=i("xdr_polling","xdr_polling",1,c),b=new Qt([p],u),w=new Qt([d],u),k=new Qt([f],u),_=new Qt([new oe(re(v),v,y)],u),S=new Qt([new oe(re(m),m,g)],u),T=new Qt([new oe(re(_),new Kt([_,new ne(S,{delay:4e3})]),S)],u),O=new oe(re(T),T,k);return r=e.useTLS?new Kt([b,new ne(O,{delay:2e3})]):new Kt([b,new ne(w,{delay:2e3}),new ne(O,{delay:5e3})]),new Zt(new ie(new oe(re(p),r,O)),o,{ttl:18e5,timeline:e.timeline,useTLS:e.useTLS})},ce={getRequest:function(t){var e=new window.XDomainRequest;return e.ontimeout=function(){t.emit("error",new f),t.close()},e.onerror=function(e){t.emit("error",e),t.close()},e.onprogress=function(){e.responseText&&e.responseText.length>0&&t.onChunk(200,e.responseText)},e.onload=function(){e.responseText&&e.responseText.length>0&&t.onChunk(200,e.responseText),t.emit("finished",200),t.close()},e},abortRequest:function(t){t.ontimeout=t.onerror=t.onprogress=t.onload=null,t.abort()}},ue=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),le=function(t){function e(e,n,o){var i=t.call(this)||this;return i.hooks=e,i.method=n,i.url=o,i}return ue(e,t),e.prototype.start=function(t){var e=this;this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=function(){e.close()},ke.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(t)},e.prototype.close=function(){this.unloader&&(ke.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)},e.prototype.onChunk=function(t,e){for(;;){var n=this.advanceBuffer(e);if(!n)break;this.emit("chunk",{status:t,data:n})}this.isBufferTooLong(e)&&this.emit("buffer_too_long")},e.prototype.advanceBuffer=function(t){var e=t.slice(this.position),n=e.indexOf("\n");return-1!==n?(this.position+=n+1,e.slice(0,n)):null},e.prototype.isBufferTooLong=function(t){return this.position===t.length&&t.length>262144},e}(ut);!function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSED=3]="CLOSED"}(se||(se={}));var he=se,pe=1;function de(t){var e=-1===t.indexOf("?")?"?":"&";return t+e+"t="+ +new Date+"&n="+pe++}function fe(t){return Math.floor(Math.random()*t)}var ve,ye=function(){function t(t,e){this.hooks=t,this.session=fe(1e3)+"/"+function(t){for(var e=[],n=0;n<t;n++)e.push(fe(32).toString(32));return e.join("")}(8),this.location=function(t){var e=/([^\?]*)\/*(\??.*)/.exec(t);return{base:e[1],queryString:e[2]}}(e),this.readyState=he.CONNECTING,this.openStream()}return t.prototype.send=function(t){return this.sendRaw(JSON.stringify([t]))},t.prototype.ping=function(){this.hooks.sendHeartbeat(this)},t.prototype.close=function(t,e){this.onClose(t,e,!0)},t.prototype.sendRaw=function(t){if(this.readyState!==he.OPEN)return!1;try{return ke.createSocketRequest("POST",de((e=this.location,n=this.session,e.base+"/"+n+"/xhr_send"))).start(t),!0}catch(t){return!1}var e,n},t.prototype.reconnect=function(){this.closeStream(),this.openStream()},t.prototype.onClose=function(t,e,n){this.closeStream(),this.readyState=he.CLOSED,this.onclose&&this.onclose({code:t,reason:e,wasClean:n})},t.prototype.onChunk=function(t){var e;if(200===t.status)switch(this.readyState===he.OPEN&&this.onActivity(),t.data.slice(0,1)){case"o":e=JSON.parse(t.data.slice(1)||"{}"),this.onOpen(e);break;case"a":e=JSON.parse(t.data.slice(1)||"[]");for(var n=0;n<e.length;n++)this.onEvent(e[n]);break;case"m":e=JSON.parse(t.data.slice(1)||"null"),this.onEvent(e);break;case"h":this.hooks.onHeartbeat(this);break;case"c":e=JSON.parse(t.data.slice(1)||"[]"),this.onClose(e[0],e[1],!0)}},t.prototype.onOpen=function(t){var e,n,o;this.readyState===he.CONNECTING?(t&&t.hostname&&(this.location.base=(e=this.location.base,n=t.hostname,(o=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(e))[1]+n+o[3])),this.readyState=he.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)},t.prototype.onEvent=function(t){this.readyState===he.OPEN&&this.onmessage&&this.onmessage({data:t})},t.prototype.onActivity=function(){this.onactivity&&this.onactivity()},t.prototype.onError=function(t){this.onerror&&this.onerror(t)},t.prototype.openStream=function(){var t=this;this.stream=ke.createSocketRequest("POST",de(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",(function(e){t.onChunk(e)})),this.stream.bind("finished",(function(e){t.hooks.onFinished(t,e)})),this.stream.bind("buffer_too_long",(function(){t.reconnect()}));try{this.stream.start()}catch(e){B.defer((function(){t.onError(e),t.onClose(1006,"Could not start streaming",!1)}))}},t.prototype.closeStream=function(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)},t}(),me={getReceiveURL:function(t,e){return t.base+"/"+e+"/xhr_streaming"+t.queryString},onHeartbeat:function(t){t.sendRaw("[]")},sendHeartbeat:function(t){t.sendRaw("[]")},onFinished:function(t,e){t.onClose(1006,"Connection interrupted ("+e+")",!1)}},ge={getReceiveURL:function(t,e){return t.base+"/"+e+"/xhr"+t.queryString},onHeartbeat:function(){},sendHeartbeat:function(t){t.sendRaw("[]")},onFinished:function(t,e){200===e?t.reconnect():t.onClose(1006,"Connection interrupted ("+e+")",!1)}},be={getRequest:function(t){var e=new(ke.getXHRAPI());return e.onreadystatechange=e.onprogress=function(){switch(e.readyState){case 3:e.responseText&&e.responseText.length>0&&t.onChunk(e.status,e.responseText);break;case 4:e.responseText&&e.responseText.length>0&&t.onChunk(e.status,e.responseText),t.emit("finished",e.status),t.close()}},e},abortRequest:function(t){t.onreadystatechange=null,t.abort()}},we={createStreamingSocket:function(t){return this.createSocket(me,t)},createPollingSocket:function(t){return this.createSocket(ge,t)},createSocket:function(t,e){return new ye(t,e)},createXHR:function(t,e){return this.createRequest(be,t,e)},createRequest:function(t,e,n){return new le(t,e,n)},createXDR:function(t,e){return this.createRequest(ce,t,e)}},ke={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:r,DependenciesReceivers:c,getDefaultStrategy:ae,Transports:St,transportConnectionInitializer:function(){var t=this;t.timeline.info(t.buildTimelineMessage({transport:t.name+(t.options.useTLS?"s":"")})),t.hooks.isInitialized()?t.changeState("initialized"):t.hooks.file?(t.changeState("initializing"),u.load(t.hooks.file,{useTLS:t.options.useTLS},(function(e,n){t.hooks.isInitialized()?(t.changeState("initialized"),n(!0)):(e&&t.onError(e),t.onClose(),n(!1))}))):t.onClose()},HTTPFactory:we,TimelineTransport:et,getXHRAPI:function(){return window.XMLHttpRequest},getWebSocketAPI:function(){return window.WebSocket||window.MozWebSocket},setup:function(t){var e=this;window.Pusher=t;var n=function(){e.onDocumentBody(t.ready)};window.JSON?n():u.load("json2",{},n)},getDocument:function(){return document},getProtocol:function(){return this.getDocument().location.protocol},getAuthorizers:function(){return{ajax:k,jsonp:Y}},onDocumentBody:function(t){var e=this;document.body?t():setTimeout((function(){e.onDocumentBody(t)}),0)},createJSONPRequest:function(t,e){return new tt(t,e)},createScriptRequest:function(t){return new Z(t)},getLocalStorage:function(){try{return window.localStorage}catch(t){return}},createXHR:function(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest:function(){return new(this.getXHRAPI())},createMicrosoftXHR:function(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork:function(){return Ot},createWebSocket:function(t){return new(this.getWebSocketAPI())(t)},createSocketRequest:function(t,e){if(this.isXHRSupported())return this.HTTPFactory.createXHR(t,e);if(this.isXDRSupported(0===e.indexOf("https:")))return this.HTTPFactory.createXDR(t,e);throw"Cross-origin HTTP requests are not supported"},isXHRSupported:function(){var t=this.getXHRAPI();return Boolean(t)&&void 0!==(new t).withCredentials},isXDRSupported:function(t){var e=t?"https:":"http:",n=this.getProtocol();return Boolean(window.XDomainRequest)&&n===e},addUnloadListener:function(t){void 0!==window.addEventListener?window.addEventListener("unload",t,!1):void 0!==window.attachEvent&&window.attachEvent("onunload",t)},removeUnloadListener:function(t){void 0!==window.addEventListener?window.removeEventListener("unload",t,!1):void 0!==window.detachEvent&&window.detachEvent("onunload",t)}};!function(t){t[t.ERROR=3]="ERROR",t[t.INFO=6]="INFO",t[t.DEBUG=7]="DEBUG"}(ve||(ve={}));var _e=ve,Se=function(){function t(t,e,n){this.key=t,this.session=e,this.events=[],this.options=n||{},this.sent=0,this.uniqueID=0}return t.prototype.log=function(t,e){t<=this.options.level&&(this.events.push(N({},e,{timestamp:B.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},t.prototype.error=function(t){this.log(_e.ERROR,t)},t.prototype.info=function(t){this.log(_e.INFO,t)},t.prototype.debug=function(t){this.log(_e.DEBUG,t)},t.prototype.isEmpty=function(){return 0===this.events.length},t.prototype.send=function(t,e){var n=this,o=N({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],t(o,(function(t,o){t||n.sent++,e&&e(t,o)})),!0},t.prototype.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},t}(),Te=function(){function t(t,e,n,o){this.name=t,this.priority=e,this.transport=n,this.options=o||{}}return t.prototype.isSupported=function(){return this.transport.isSupported({useTLS:this.options.useTLS})},t.prototype.connect=function(t,e){var n=this;if(!this.isSupported())return Oe(new b,e);if(this.priority<t)return Oe(new v,e);var o=!1,i=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),r=null,s=function(){i.unbind("initialized",s),i.connect()},a=function(){r=Jt.createHandshake(i,(function(t){o=!0,l(),e(null,t)}))},c=function(t){l(),e(t)},u=function(){var t;l(),t=Q(i),e(new y(t))},l=function(){i.unbind("initialized",s),i.unbind("open",a),i.unbind("error",c),i.unbind("closed",u)};return i.bind("initialized",s),i.bind("open",a),i.bind("error",c),i.bind("closed",u),i.initialize(),{abort:function(){o||(l(),r?r.close():i.close())},forceMinPriority:function(t){o||n.priority<t&&(r?r.close():i.close())}}},t}();function Oe(t,e){return B.defer((function(){e(t)})),{abort:function(){},forceMinPriority:function(){}}}var Ce=ke.Transports,Pe=function(t,e,n,o,i,r){var s,a=Ce[n];if(!a)throw new g(n);return t.enabledTransports&&-1===W(t.enabledTransports,e)||t.disabledTransports&&-1!==W(t.disabledTransports,e)?s=Ee:(i=Object.assign({ignoreNullOrigin:t.ignoreNullOrigin},i),s=new Te(e,o,r?r.getAssistant(a):a,i)),s},Ee={isSupported:function(){return!1},connect:function(t,e){var n=B.defer((function(){e(new b)}));return{abort:function(){n.ensureAborted()},forceMinPriority:function(){}}}};function xe(t){return t.httpHost?t.httpHost:t.cluster?"sockjs-"+t.cluster+".pusher.com":s.httpHost}function Ae(t){return t.wsHost?t.wsHost:t.cluster?je(t.cluster):je(s.cluster)}function je(t){return"ws-"+t+".pusher.com"}function Ie(t){return"https:"===ke.getProtocol()||!1!==t.forceTLS}function Le(t){return"enableStats"in t?t.enableStats:"disableStats"in t&&!t.disableStats}var Re=function(){function t(e,n){var o,i,r=this;if(function(t){if(null==t)throw"You must pass your app key when you instantiate Pusher."}(e),!(n=n||{}).cluster&&!n.wsHost&&!n.httpHost){var a=h("javascriptQuickStart");K.warn("You should always specify a cluster when connecting. "+a)}"disableStats"in n&&K.warn("The disableStats option is deprecated in favor of enableStats"),this.key=e,this.config=(i={activityTimeout:(o=n).activityTimeout||s.activityTimeout,authEndpoint:o.authEndpoint||s.authEndpoint,authTransport:o.authTransport||s.authTransport,cluster:o.cluster||s.cluster,httpPath:o.httpPath||s.httpPath,httpPort:o.httpPort||s.httpPort,httpsPort:o.httpsPort||s.httpsPort,pongTimeout:o.pongTimeout||s.pongTimeout,statsHost:o.statsHost||s.stats_host,unavailableTimeout:o.unavailableTimeout||s.unavailableTimeout,wsPath:o.wsPath||s.wsPath,wsPort:o.wsPort||s.wsPort,wssPort:o.wssPort||s.wssPort,enableStats:Le(o),httpHost:xe(o),useTLS:Ie(o),wsHost:Ae(o)},"auth"in o&&(i.auth=o.auth),"authorizer"in o&&(i.authorizer=o.authorizer),"disabledTransports"in o&&(i.disabledTransports=o.disabledTransports),"enabledTransports"in o&&(i.enabledTransports=o.enabledTransports),"ignoreNullOrigin"in o&&(i.ignoreNullOrigin=o.ignoreNullOrigin),"timelineParams"in o&&(i.timelineParams=o.timelineParams),"nacl"in o&&(i.nacl=o.nacl),i),this.channels=Jt.createChannels(),this.global_emitter=new ut,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new Se(this.key,this.sessionID,{cluster:this.config.cluster,features:t.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:_e.INFO,version:s.VERSION}),this.config.enableStats&&(this.timelineSender=Jt.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+ke.TimelineTransport.name})),this.connection=Jt.createConnectionManager(this.key,{getStrategy:function(t){return ke.getDefaultStrategy(r.config,t,Pe)},timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:Boolean(this.config.useTLS)}),this.connection.bind("connected",(function(){r.subscribeAll(),r.timelineSender&&r.timelineSender.send(r.connection.isUsingTLS())})),this.connection.bind("message",(function(t){var e=0===t.event.indexOf("pusher_internal:");if(t.channel){var n=r.channel(t.channel);n&&n.handleEvent(t)}e||r.global_emitter.emit(t.event,t.data)})),this.connection.bind("connecting",(function(){r.channels.disconnect()})),this.connection.bind("disconnected",(function(){r.channels.disconnect()})),this.connection.bind("error",(function(t){K.warn(t)})),t.instances.push(this),this.timeline.info({instances:t.instances.length}),t.isReady&&this.connect()}return t.ready=function(){t.isReady=!0;for(var e=0,n=t.instances.length;e<n;e++)t.instances[e].connect()},t.getClientFeatures=function(){return z(X({ws:ke.Transports.ws},(function(t){return t.isSupported({})})))},t.prototype.channel=function(t){return this.channels.find(t)},t.prototype.allChannels=function(){return this.channels.all()},t.prototype.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isUsingTLS(),e=this.timelineSender;this.timelineSenderTimer=new D(6e4,(function(){e.send(t)}))}},t.prototype.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},t.prototype.bind=function(t,e,n){return this.global_emitter.bind(t,e,n),this},t.prototype.unbind=function(t,e,n){return this.global_emitter.unbind(t,e,n),this},t.prototype.bind_global=function(t){return this.global_emitter.bind_global(t),this},t.prototype.unbind_global=function(t){return this.global_emitter.unbind_global(t),this},t.prototype.unbind_all=function(t){return this.global_emitter.unbind_all(),this},t.prototype.subscribeAll=function(){var t;for(t in this.channels.channels)this.channels.channels.hasOwnProperty(t)&&this.subscribe(t)},t.prototype.subscribe=function(t){var e=this.channels.add(t,this);return e.subscriptionPending&&e.subscriptionCancelled?e.reinstateSubscription():e.subscriptionPending||"connected"!==this.connection.state||e.subscribe(),e},t.prototype.unsubscribe=function(t){var e=this.channels.find(t);e&&e.subscriptionPending?e.cancelSubscription():(e=this.channels.remove(t))&&e.subscribed&&e.unsubscribe()},t.prototype.send_event=function(t,e,n){return this.connection.send_event(t,e,n)},t.prototype.shouldUseTLS=function(){return this.config.useTLS},t.instances=[],t.isReady=!1,t.logToConsole=!1,t.Runtime=ke,t.ScriptReceivers=ke.ScriptReceivers,t.DependenciesReceivers=ke.DependenciesReceivers,t.auth_callbacks=ke.auth_callbacks,t}(),Me=e.default=Re;ke.setup(Re)}])},t.exports=o()}]);