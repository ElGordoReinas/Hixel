const workerOptions={OggOpusEncoderWasmPath:"https://cdn.jsdelivr.net/npm/opus-media-recorder@latest/OggOpusEncoder.wasm",WebMOpusEncoderWasmPath:"https://cdn.jsdelivr.net/npm/opus-media-recorder@latest/WebMOpusEncoder.wasm"};window.MediaRecorder=OpusMediaRecorder;let rrecbtn=$("#record-record"),rstpbtn=$("#record-stop"),raudio=$("#record-audio"),rrembtn=$("#record-remove"),c="<i class=\"fa fa-microphone\" data-s=\"1\"></i>",p="<i class=\"fa fa-circle\"></i>",r="<i class=\"fa fa-microphone\"></i>";function startRecoder(a){navigator.mediaDevices.getUserMedia({audio:!0}).then(b=>{recorder=new MediaRecorder(b,{audioBitsPerSecond:32e3,mimeType:"audio/ogg"},workerOptions),recorder.ondataavailable=function(a){rchunks.push(a.data)},recorder.onstop=function(){rrecbtn.html(r),rstpbtn.hide(),rrembtn.show();let a=new Blob(rchunks,{type:"audio/ogg"}),b=URL.createObjectURL(a);raudio.attr("src",b),raudio.show()},recorder.onpause=function(){rrecbtn.html(c)},recorder.onstart=function(){rchunks=[],raudio.attr("src",""),rrembtn.hide(),raudio.hide(),rrecbtn.html(p)},recorder.onresume=function(){rrecbtn.html(p)},a&&a()})}rrecbtn.on("click",function(){$(this).html()===p?recorder.pause():$(this).html()===c?recorder.resume():startRecoder(function(){recorder.start(),rstpbtn.show()})}),rrembtn.on("click",function(){raudio.attr("src",""),rrembtn.hide(),raudio.hide(),rrecbtn.html(r),rchunks=[],recorder.stream.getTracks().forEach(a=>a.stop())}),rstpbtn.on("click",function(){recorder.stop()});